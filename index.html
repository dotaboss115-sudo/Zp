<!DOCTYPE html>

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–í–∞—Ö—Ç–∞ Live Pro</title>
    <style>
        :root{
            --bg:#0a0a0a;--bg2:#141414;--card:#1a1a1a;--elev:#222;
            --accent:#00ff88;--accent2:#00cc6a;--gold:#ffd700;--orange:#ff9500;
            --red:#ff453a;--blue:#0a84ff;--purple:#bf5af2;
            --text:#fff;--text2:rgba(255,255,255,.85);--muted:rgba(255,255,255,.5);
            --border:rgba(255,255,255,.08);
        }

```
    [data-theme="amoled"]{
        --bg:#000000;--bg2:#000000;--card:#000000;--elev:#0a0a0a;
        --border:rgba(255,255,255,.02);
    }
    [data-theme="amoled"] .card{
        box-shadow:0 0 0 1px rgba(255,255,255,.02);
    }
    [data-theme="amoled"] .live-card{
        box-shadow:0 0 0 1px rgba(255,255,255,.03);
    }
    
    [data-theme="rosneft"]{
        --bg:#1a1412;--bg2:#221a16;--card:#2a2219;--elev:#32281d;
        --accent:#ffd700;--accent2:#f4d03f;--gold:#f4d03f;
        --rosneft-red:#8b2500;--rosneft-dark:#120a06;
        --text:#ffffff;--text2:#f5f5f5;--muted:rgba(255,255,255,.7);
        --border:rgba(212,175,55,.12);
    }
    [data-theme="rosneft"] body{
        background:linear-gradient(180deg,#1a1412 0%,#120a06 100%);
    }
    [data-theme="rosneft"] .header{
        background:linear-gradient(135deg,rgba(42,34,25,.98),rgba(26,20,18,.98));
        backdrop-filter:blur(20px);
        border-bottom:1px solid rgba(212,175,55,.2);
        box-shadow:0 2px 20px rgba(0,0,0,.3);
    }
    [data-theme="rosneft"] .logo-icon{
        background:linear-gradient(135deg,#ffd700,#f4d03f);
        box-shadow:0 4px 20px rgba(255,215,0,.4),inset 0 1px 0 rgba(255,255,255,.3);
        color:#1a1412;
    }
    [data-theme="rosneft"] .logo-text{
        color:#ffd700;
        text-shadow:0 2px 10px rgba(255,215,0,.5);
        font-weight:700;
    }
    [data-theme="rosneft"] .xp-card{
        background:linear-gradient(135deg,#2a2219,#32281d);
        border:1px solid rgba(212,175,55,.3);
        box-shadow:0 8px 32px rgba(0,0,0,.4),inset 0 1px 0 rgba(212,175,55,.1);
    }
    [data-theme="rosneft"] .xp-level,
    [data-theme="rosneft"] .xp-text{
        color:#ffffff;
    }
    [data-theme="rosneft"] .live-card{
        background:linear-gradient(180deg,#2a2219,#221a16);
        border:1px solid rgba(212,175,55,.2);
        box-shadow:0 8px 32px rgba(0,0,0,.3);
    }
    [data-theme="rosneft"] .live-text{
        color:#ffd700;
        font-weight:700;
    }
    [data-theme="rosneft"] .live-card::before{
        background:linear-gradient(90deg,#ffd700,#f4d03f,#ffd700);
    }
    [data-theme="rosneft"] .badge{
        background:linear-gradient(135deg,rgba(255,215,0,.15),rgba(244,208,63,.1));
        border:1px solid rgba(255,215,0,.4);
        color:#ffd700;
        box-shadow:0 0 15px rgba(255,215,0,.2);
        text-shadow:0 1px 3px rgba(0,0,0,.3);
    }
    [data-theme="rosneft"] .money-val{
        color:#ffd700;
        text-shadow:0 2px 20px rgba(255,215,0,.6);
    }
    [data-theme="rosneft"] .money-kop,
    [data-theme="rosneft"] .money-cur{
        color:#ffd700;
    }
    [data-theme="rosneft"] .money-ps{
        color:#f4d03f;
    }
    [data-theme="rosneft"] .profile-card{
        background:linear-gradient(135deg,#2a2219,#32281d);
        border:1px solid rgba(212,175,55,.25);
        box-shadow:0 12px 40px rgba(0,0,0,.4);
    }
    [data-theme="rosneft"] .profile-bg{
        background:linear-gradient(135deg,rgba(255,215,0,.15),rgba(139,37,0,.08));
    }
    [data-theme="rosneft"] .profile-name{
        color:#ffffff;
    }
    [data-theme="rosneft"] .stat3{
        background:linear-gradient(135deg,#2a2219,#32281d);
        border:1px solid rgba(212,175,55,.15);
    }
    [data-theme="rosneft"] .stat3-val{
        color:#ffd700;
    }
    [data-theme="rosneft"] .stat3:hover{
        box-shadow:0 4px 20px rgba(255,215,0,.2);
        border-color:rgba(255,215,0,.3);
    }
    [data-theme="rosneft"] .card{
        background:linear-gradient(135deg,#2a2219,#32281d);
        border:1px solid rgba(212,175,55,.15);
        box-shadow:0 4px 20px rgba(0,0,0,.3);
    }
    [data-theme="rosneft"] .card-title{
        color:#ffffff;
    }
    [data-theme="rosneft"] .bottom-nav{
        background:linear-gradient(to top,rgba(26,20,18,.98),rgba(34,26,22,.95));
        backdrop-filter:blur(20px);
        border-top:1px solid rgba(212,175,55,.2);
    }
    [data-theme="rosneft"] .nav-item{
        color:rgba(255,255,255,.7);
    }
    [data-theme="rosneft"] .nav-item.active{
        background:linear-gradient(135deg,rgba(255,215,0,.15),rgba(184,148,30,.1));
        border:1px solid rgba(255,215,0,.3);
        box-shadow:0 0 15px rgba(255,215,0,.15);
        color:#ffd700;
    }
    [data-theme="rosneft"] .prog-fill{
        background:linear-gradient(90deg,#b8941e,#ffd700,#f4d03f);
        box-shadow:0 0 15px rgba(255,215,0,.4);
    }
    [data-theme="rosneft"] .xp-fill{
        background:linear-gradient(90deg,#ffd700,#f4d03f);
        box-shadow:0 0 20px rgba(255,215,0,.5);
    }
    [data-theme="rosneft"] .timer-widget{
        background:linear-gradient(135deg,rgba(255,215,0,.08),rgba(184,148,30,.05));
        border:1px solid rgba(255,215,0,.2);
    }
    [data-theme="rosneft"] .timer-display{
        color:#ffd700;
        text-shadow:0 0 25px rgba(255,215,0,.4);
    }
    [data-theme="rosneft"] .comparison-change.up{
        color:#ffd700;
        background:rgba(255,215,0,.12);
        border-color:rgba(255,215,0,.3);
    }
    [data-theme="rosneft"] #rosneftSlogan{
        color:#ffd700;
        background:linear-gradient(135deg,rgba(255,215,0,.08),rgba(184,148,30,.05));
        border:1px solid rgba(255,215,0,.25);
        text-shadow:0 0 10px rgba(255,215,0,.3);
    }
    
    [data-theme="blue"]{
        --accent:#00a8ff;--accent2:#0077cc;
    }
    [data-theme="purple"]{
        --accent:#bf5af2;--accent2:#9933cc;
    }
    [data-theme="green"]{
        --accent:#00ff88;--accent2:#00cc6a;
    }
    
    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Helvetica Neue',Arial,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:background .3s,color .3s;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    body{padding-bottom:calc(85px + env(safe-area-inset-bottom));overflow-x:hidden}
    
    .header{position:sticky;top:0;z-index:50;background:rgba(0,0,0,.95);backdrop-filter:blur(20px);padding:12px 16px;padding-top:calc(12px + env(safe-area-inset-top));border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    [data-theme="light"] .header{background:rgba(255,255,255,.95)}
    
    .logo{display:flex;align-items:center;gap:10px}
    .logo-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;animation:float 3s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
    
    .logo-text{font-size:1.2rem;font-weight:700;background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .header-right{display:flex;align-items:center;gap:8px}
    .badge{font-size:.6rem;padding:4px 8px;background:rgba(0,255,136,.15);color:var(--accent);border-radius:6px;font-weight:600;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.05);opacity:.8}}
    
    .theme-btn{width:32px;height:32px;border-radius:8px;background:var(--card);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem}
    
    .container{padding:16px}

    /* XP & Level System */
    .xp-card{background:linear-gradient(135deg,var(--purple),var(--blue));border-radius:20px;padding:20px;margin-bottom:16px;position:relative;overflow:hidden}
    .xp-card::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="10" cy="10" r="1" fill="white" opacity="0.1"/><circle cx="90" cy="20" r="1.5" fill="white" opacity="0.1"/><circle cx="30" cy="80" r="1" fill="white" opacity="0.1"/><circle cx="70" cy="60" r="1.2" fill="white" opacity="0.1"/></svg>');animation:stars 20s linear infinite}
    @keyframes stars{0%{transform:translateY(0)}100%{transform:translateY(-100px)}}
    
    .xp-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .xp-level{font-size:2rem;font-weight:800;text-shadow:0 0 20px rgba(255,255,255,.5)}
    .xp-avatar{width:50px;height:50px;border-radius:50%;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:1.5rem;border:3px solid rgba(255,255,255,.3);animation:spin 10s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    
    .xp-bar{height:8px;background:rgba(0,0,0,.3);border-radius:10px;overflow:hidden;margin-bottom:8px}
    .xp-fill{height:100%;background:linear-gradient(90deg,var(--gold),#fff);border-radius:10px;transition:width 1s cubic-bezier(.4,0,.2,1);position:relative;box-shadow:0 0 10px var(--gold)}
    .xp-fill::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:shimmer 2s infinite}
    @keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
    
    .xp-text{font-size:.75rem;opacity:.9}
    .achievements{display:flex;gap:8px;margin-top:12px;overflow-x:auto;padding:4px 0}
    .achievements::-webkit-scrollbar{display:none}
    .ach{width:40px;height:40px;border-radius:10px;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0;border:2px solid rgba(255,255,255,.3);cursor:pointer;transition:transform .2s}
    .ach:active{transform:scale(.9)}
    .ach.locked{opacity:.3;filter:grayscale(1)}
    
    /* Live Card Enhanced */
    .live-card{background:linear-gradient(180deg,var(--card),var(--bg2));border-radius:24px;padding:24px;margin-bottom:16px;border:1px solid var(--border);position:relative;overflow:hidden}
    .live-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--accent),var(--gold),var(--accent));background-size:200%;animation:gradient-shift 3s linear infinite}
    @keyframes gradient-shift{0%{background-position:0}100%{background-position:200%}}
    
    .live-status{display:flex;align-items:center;gap:8px;margin-bottom:16px}
    .live-dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 10px var(--accent);animation:pulse-dot 1.5s ease-in-out infinite}
    @keyframes pulse-dot{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.2);opacity:.7}}
    .live-dot.off{background:var(--orange);box-shadow:none;animation:none}
    .live-dot.holiday{background:var(--gold)}
    .live-dot.road{background:var(--blue)}
    
    .live-text{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:1px}
    .live-text.on{color:var(--accent)}.live-text.off{color:var(--orange)}.live-text.holiday{color:var(--gold)}.live-text.road{color:var(--blue)}
    .live-time{margin-left:auto;font-family:monospace;font-size:.8rem;color:var(--muted)}
    
    /* Timer Widget */
    .timer-widget{background:linear-gradient(135deg,rgba(0,255,136,.1),rgba(0,204,106,.1));border-radius:16px;padding:16px;margin-bottom:16px;border:1px solid rgba(0,255,136,.2)}
    .timer-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .timer-title{font-size:.8rem;color:var(--accent);font-weight:600}
    .timer-display{font-family:monospace;font-size:2.5rem;font-weight:700;text-align:center;color:var(--accent);text-shadow:0 0 20px rgba(0,255,136,.3);margin-bottom:8px}
    .timer-label{text-align:center;font-size:.7rem;color:var(--text2)}
    
    /* Money Display Enhanced */
    .money{text-align:center;margin-bottom:20px;position:relative}
    .money-label{font-size:.8rem;color:var(--muted);margin-bottom:8px}
    .money-amount{font-family:monospace;font-size:3.2rem;font-weight:700;display:flex;align-items:baseline;justify-content:center;gap:4px;position:relative}
    .money-val{background:linear-gradient(135deg,var(--accent),#0fa,var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-size:200%;animation:shine 3s linear infinite;position:relative}
    @keyframes shine{0%{background-position:0}100%{background-position:200%}}
    
    .money-val.counting{animation:count-up .5s ease-out}
    @keyframes count-up{0%{transform:scale(1.2);opacity:.5}100%{transform:scale(1);opacity:1}}
    
    .money-kop{font-size:1.2rem;color:var(--accent2);opacity:.7}
    .money-cur{font-size:1.5rem;color:var(--accent2)}
    .money-ps{font-size:.75rem;color:var(--muted);margin-top:8px}
    .money-ps span{color:var(--accent);font-weight:600}
    
    /* Falling Money Animation */
    .money-particle{position:absolute;font-size:1.5rem;pointer-events:none;animation:fall 3s ease-in forwards;opacity:0}
    @keyframes fall{0%{transform:translateY(-50px) rotate(0deg);opacity:1}100%{transform:translateY(200px) rotate(720deg);opacity:0}}
    
    /* Shift Progress */
    .shift-prog{margin-top:20px}
    .shift-head{display:flex;justify-content:space-between;margin-bottom:8px;font-size:.75rem}
    .shift-head span:last-child{color:var(--accent);font-family:monospace}
    .prog-track{height:6px;background:var(--bg);border-radius:10px;overflow:hidden}
    .prog-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--gold));border-radius:10px;transition:width 1s;position:relative}
    .prog-fill::after{content:'';position:absolute;right:0;top:50%;transform:translateY(-50%);width:12px;height:12px;background:var(--accent);border-radius:50%;box-shadow:0 0 10px var(--accent);animation:pulse-dot 1s ease-in-out infinite}
    .shift-labels{display:flex;justify-content:space-between;margin-top:6px;font-size:.65rem;color:var(--muted)}
    
    /* Stats Grid */
    .stats3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px}
    .stat3{background:var(--card);border-radius:16px;padding:14px 12px;text-align:center;border:1px solid var(--border);transition:transform .2s,box-shadow .2s;cursor:pointer}
    .stat3:active{transform:scale(.95)}
    .stat3:hover{box-shadow:0 8px 20px rgba(0,255,136,.1)}
    .stat3-val{font-family:monospace;font-size:1.1rem;font-weight:700;margin-bottom:4px}
    .stat3-lbl{font-size:.6rem;color:var(--muted);text-transform:uppercase}
    
    /* Salary Predictions */
    .salary-card{background:linear-gradient(135deg,var(--card),var(--elev));border-radius:20px;padding:20px;margin-bottom:16px;border:1px solid var(--border)}
    .salary-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .salary-title{font-size:.9rem;font-weight:600;display:flex;align-items:center;gap:8px}
    .salary-item{background:var(--bg2);border-radius:12px;padding:14px;margin-bottom:10px;border:1px solid var(--border)}
    .salary-date{font-size:.7rem;color:var(--muted);margin-bottom:4px}
    .salary-amount{font-family:monospace;font-size:1.4rem;font-weight:700;color:var(--accent);display:flex;align-items:center;gap:8px}
    .salary-type{font-size:.65rem;padding:4px 8px;background:rgba(0,255,136,.15);color:var(--accent);border-radius:6px;font-weight:600}
    .salary-countdown{font-size:.65rem;color:var(--gold);margin-top:4px}
    
    /* Card Standard */
    .card{background:var(--card);border-radius:20px;padding:20px;margin-bottom:16px;border:1px solid var(--border)}
    .card-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .card-title{font-size:.9rem;font-weight:600}
    .toggle-wrap{display:flex;gap:8px}
    .toggle-btn{padding:6px 12px;border-radius:8px;font-size:.7rem;font-weight:600;border:1px solid var(--border);background:var(--bg2);color:var(--muted);cursor:pointer;transition:all .2s}
    .toggle-btn.on{background:var(--accent);color:var(--bg);border-color:var(--accent);transform:scale(1.05)}
    
    /* Breakdown */
    .bk-row{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--bg2);border-radius:10px;margin-bottom:6px;font-size:.75rem;transition:transform .2s}
    .bk-row:active{transform:scale(.98)}
    .bk-row.hl{background:rgba(0,255,136,.1);border:1px solid rgba(0,255,136,.3)}
    .bk-row.total{background:linear-gradient(135deg,rgba(0,255,136,.1),rgba(255,215,0,.1));border:1px solid var(--accent);margin-top:8px}
    .bk-lbl{color:var(--text2);display:flex;align-items:center;gap:6px}
    .bk-pct{font-size:.6rem;padding:2px 6px;background:var(--elev);border-radius:4px;color:var(--muted)}
    .bk-val{font-family:monospace;font-weight:600}
    .bk-row.total .bk-lbl{color:var(--text);font-weight:600}
    .bk-row.total .bk-val{color:var(--accent);font-size:1rem}
    
    /* Vahta Progress */
    .vahta-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}
    .vahta-info h3{font-size:.9rem;margin-bottom:4px}
    .vahta-dates{font-size:.7rem;color:var(--muted)}
    .vahta-pct{font-family:monospace;font-size:1.8rem;font-weight:700;color:var(--accent)}
    .vahta-prog{height:8px;background:var(--bg);border-radius:10px;overflow:hidden;margin-bottom:12px}
    .vahta-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--blue));border-radius:10px;transition:width 1s}
    .vahta-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    .vs{text-align:center;padding:10px 6px;background:var(--bg2);border-radius:10px;transition:transform .2s}
    .vs:active{transform:scale(.95)}
    .vs-val{font-family:monospace;font-size:1rem;font-weight:700;margin-bottom:2px}
    .vs-lbl{font-size:.55rem;color:var(--muted);text-transform:uppercase}
    
    /* Calendar */
    .cal-section{background:var(--card);border-radius:20px;padding:16px;margin-bottom:16px;border:1px solid var(--border)}
    .cal-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .cal-btn{width:32px;height:32px;border-radius:8px;background:var(--bg2);border:1px solid var(--border);color:var(--text);font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
    .cal-btn:active{background:var(--accent);color:var(--bg);transform:scale(.9)}
    .cal-title{font-size:.95rem;font-weight:600}
    .cal-wdays{display:grid;grid-template-columns:repeat(7,1fr);margin-bottom:8px}
    .cal-wd{text-align:center;font-size:.6rem;color:var(--muted);padding:8px 0;font-weight:500}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px}
    .cal-day{aspect-ratio:1;display:flex;flex-direction:column;align-items:center;justify-content:center;border-radius:8px;font-size:.8rem;font-weight:500;cursor:pointer;background:var(--bg2);border:2px solid transparent;transition:all .2s;position:relative}
    .cal-day:active{transform:scale(.9)}
    .cal-day.empty{background:transparent;pointer-events:none}
    .cal-day.vm{background:rgba(0,255,136,.15);border-color:rgba(0,255,136,.3);color:var(--accent)}
    .cal-day.vo{background:rgba(255,69,58,.1);border-color:rgba(255,69,58,.2);color:var(--red)}
    .cal-day.road{background:rgba(10,132,255,.15);border-color:rgba(10,132,255,.3);color:var(--blue)}
    .cal-day.vacation{background:rgba(191,90,242,.15);border-color:rgba(191,90,242,.3);color:var(--purple)}
    .cal-day.holiday{background:rgba(255,215,0,.2);border-color:rgba(255,215,0,.4);color:var(--gold)}
    .cal-day.hospital{background:rgba(255,149,0,.15);border-color:rgba(255,149,0,.3);color:var(--orange)}
    .cal-day.today{box-shadow:0 0 0 2px var(--gold),0 0 15px rgba(255,215,0,.4);animation:glow 2s ease-in-out infinite}
    @keyframes glow{0%,100%{box-shadow:0 0 0 2px var(--gold),0 0 15px rgba(255,215,0,.4)}50%{box-shadow:0 0 0 2px var(--gold),0 0 25px rgba(255,215,0,.6)}}
    .cal-day.past{opacity:.5}
    .cal-day-num{font-size:.85rem;line-height:1}
    .cal-day-lbl{font-size:.4rem;margin-top:1px;text-transform:uppercase;opacity:.9}
    .cal-legend{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px;padding-top:12px;border-top:1px solid var(--border)}
    .leg-item{display:flex;align-items:center;gap:4px;font-size:.6rem;color:var(--muted)}
    .leg-dot{width:8px;height:8px;border-radius:3px}
    
    /* Edit Overlay */
    .edit-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.9);z-index:100;display:none;align-items:flex-end}
    .edit-overlay.show{display:flex}
    .edit-panel{width:100%;background:var(--card);border-radius:24px 24px 0 0;padding:24px;padding-bottom:calc(24px + env(safe-area-inset-bottom));animation:slideUp .3s}
    @keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
    .edit-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
    .edit-title{font-size:1rem}
    .edit-close{width:32px;height:32px;border-radius:50%;background:var(--bg2);border:none;color:var(--text2);font-size:1.2rem;cursor:pointer}
    .edit-date{font-size:.8rem;color:var(--muted);margin-bottom:16px}
    .edit-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .edit-btn{padding:16px 10px;border-radius:14px;border:2px solid var(--border);background:var(--bg2);color:var(--text2);font-size:.7rem;font-weight:600;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:6px;font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;transition:all .2s}
    .edit-btn:active{transform:scale(.95)}
    .edit-btn.vm{border-color:var(--accent);color:var(--accent)}
    .edit-btn.road{border-color:var(--blue);color:var(--blue)}
    .edit-btn.vo{border-color:var(--red);color:var(--red)}
    .edit-btn.vacation{border-color:var(--purple);color:var(--purple)}
    .edit-btn.holiday{border-color:var(--gold);color:var(--gold)}
    .edit-btn.hospital{border-color:var(--orange);color:var(--orange)}
    .edit-icon{font-size:1.4rem}
    
    /* Bottom Nav */
    .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:rgba(10,10,10,.95);backdrop-filter:blur(20px);border-top:1px solid var(--border);padding:8px 10px;padding-bottom:calc(8px + env(safe-area-inset-bottom));display:flex;justify-content:space-around;z-index:50}
    [data-theme="light"] .bottom-nav{background:rgba(255,255,255,.95)}
    .nav-item{display:flex;flex-direction:column;align-items:center;gap:4px;padding:8px 12px;border-radius:12px;color:var(--muted);font-size:.5rem;cursor:pointer;transition:all .2s;position:relative}
    .nav-item.active{color:var(--accent);background:rgba(0,255,136,.1);transform:scale(1.05)}
    .nav-icon{font-size:1.1rem;transition:transform .2s}
    .nav-item.active .nav-icon{transform:scale(1.1)}
    
    /* Tabs */
    .tab-content{position:absolute;opacity:0;visibility:hidden;transition:opacity .3s,visibility .3s;width:100%;left:0;top:60px;padding:16px;padding-bottom:80px}
    .tab-content.active{position:relative;opacity:1;visibility:visible}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @keyframes fadeOut{to{opacity:0}}
    
    /* Settings */
    .set-section{margin-bottom:24px}
    .set-title{font-size:.8rem;color:var(--muted);margin-bottom:12px;padding-left:4px}
    .set-row{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:var(--card);border:1px solid var(--border);border-radius:12px;margin-bottom:8px;transition:all .2s}
    .set-row:active{transform:scale(.98)}
    .set-lbl{font-size:.8rem}
    .set-input{width:100px;padding:10px 12px;border-radius:8px;background:var(--bg);border:1px solid var(--border);color:var(--text);font-family:monospace;font-size:.9rem;text-align:right;outline:none;transition:border .2s}
    .set-input:focus{border-color:var(--accent)}
    .save-btn{width:100%;padding:16px;border-radius:14px;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;color:var(--bg);font-size:.9rem;font-weight:700;cursor:pointer;font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;margin-top:16px;transition:transform .2s}
    .save-btn:active{transform:scale(.98)}
    
    /* Premium Profile Card */
    .profile-card{background:linear-gradient(135deg,var(--card),var(--elev));border-radius:24px;padding:0;margin-bottom:16px;border:1px solid var(--border);position:relative;overflow:hidden;box-shadow:0 12px 40px rgba(0,0,0,.15)}
    .profile-bg{position:absolute;top:0;left:0;right:0;height:140px;background:linear-gradient(135deg,var(--accent),var(--accent2));opacity:.12;animation:profileBg 15s ease infinite}
    @keyframes profileBg{0%,100%{opacity:.12}50%{opacity:.18}}
    .profile-content{position:relative;padding:24px}
    .profile-header{display:flex;align-items:center;gap:16px;margin-bottom:24px}
    .profile-avatar{width:75px;height:75px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:800;color:var(--bg);border:5px solid var(--card);box-shadow:0 8px 24px rgba(0,0,0,.25),inset 0 2px 0 rgba(255,255,255,.2);position:relative;overflow:hidden}
    .profile-avatar::after{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);animation:avatarShine 3s ease-in-out infinite}
    @keyframes avatarShine{0%,100%{left:-100%}50%{left:100%}}
    .profile-info{flex:1}
    .profile-name{font-size:1.4rem;font-weight:700;margin-bottom:6px;background:linear-gradient(135deg,var(--text),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .profile-rank{font-size:0.8rem;color:var(--accent);font-weight:600;display:flex;align-items:center;gap:6px;padding:4px 10px;background:rgba(0,255,136,.1);border-radius:8px;display:inline-flex}
    .profile-edit-btn{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem;transition:all .3s;box-shadow:0 4px 12px rgba(0,255,136,.3)}
    .profile-edit-btn:active{transform:scale(.9) rotate(90deg)}
    .profile-stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .profile-stat{background:var(--bg2);border-radius:18px;padding:18px;border:1px solid var(--border);text-align:center;transition:all .3s;position:relative;overflow:hidden;cursor:pointer}
    .profile-stat::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,var(--accent),transparent);opacity:0;transition:opacity .3s}
    .profile-stat:active{transform:scale(.96)}
    .profile-stat:active::before{opacity:.05}
    .profile-stat-icon{font-size:2rem;margin-bottom:10px;filter:drop-shadow(0 2px 8px rgba(0,255,136,.3))}
    .profile-stat-label{font-size:0.65rem;color:var(--muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.8px;font-weight:600}
    .profile-stat-value{font-family:'SF Mono','SF Pro Display',monospace;font-size:1.1rem;font-weight:700;color:var(--accent);text-shadow:0 0 10px rgba(0,255,136,.2)}
    .profile-streak{position:absolute;top:12px;right:12px;background:linear-gradient(135deg,#ff6b35,#f7931e);color:#fff;padding:6px 12px;border-radius:20px;font-size:0.7rem;font-weight:700;box-shadow:0 4px 12px rgba(255,107,53,.4);animation:pulse 2s ease-in-out infinite}
    
    /* Comparison */
    .comparison-grid{display:grid;grid-template-columns:1fr auto 1fr;gap:20px;align-items:center;padding:20px;background:var(--bg2);border-radius:16px}
    .comparison-item{text-align:center}
    .comparison-label{font-size:0.7rem;color:var(--muted);margin-bottom:10px;text-transform:uppercase;letter-spacing:0.5px}
    .comparison-value{font-family:'SF Mono',monospace;font-size:1.5rem;font-weight:700;text-shadow:0 0 15px currentColor}
    .comparison-value.current{color:var(--accent);animation:glow 2s ease-in-out infinite}
    .comparison-value.prev{color:var(--muted);opacity:.6}
    @keyframes glow{0%,100%{opacity:1}50%{opacity:.8}}
    .comparison-arrow{display:flex;flex-direction:column;align-items:center;gap:4px}
    .comparison-arrow::before{content:'‚Üí';font-size:1.5rem;color:var(--muted);opacity:.3}
    .comparison-change{font-size:1.1rem;font-weight:700;padding:10px 16px;border-radius:12px;background:var(--bg);border:1px solid var(--border);min-width:80px}
    .comparison-change.up{color:#00ff88;background:rgba(0,255,136,.12);border-color:rgba(0,255,136,.3);box-shadow:0 0 20px rgba(0,255,136,.2)}
    .comparison-change.down{color:#ff453a;background:rgba(255,69,58,.12);border-color:rgba(255,69,58,.3);box-shadow:0 0 20px rgba(255,69,58,.2)}
    
    /* Quick Actions */
    .quick-btn{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:16px;background:linear-gradient(135deg,var(--card),var(--elev));border:1px solid var(--border);border-radius:14px;cursor:pointer;transition:all .2s;min-height:80px}
    .quick-btn:active{transform:scale(.95)}
    .quick-btn:hover{border-color:var(--accent);box-shadow:0 4px 15px rgba(0,255,136,.15)}
    .quick-goal-btn{display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg2);border:1px solid var(--border);border-radius:12px;cursor:pointer;transition:all .2s;font-size:0.85rem;font-weight:600;color:var(--text)}
    .quick-goal-btn:active{transform:scale(.97);background:var(--accent);color:var(--bg);border-color:var(--accent)}
    
    /* Theme Selector */
    .theme-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:16px}
    .theme-opt{padding:16px;border-radius:12px;border:2px solid var(--border);background:var(--bg2);cursor:pointer;text-align:center;font-size:.75rem;font-weight:600;transition:all .2s}
    .theme-opt.active{border-color:var(--accent);background:rgba(0,255,136,.1);transform:scale(1.05)}
    .theme-opt:active{transform:scale(.95)}
    
    /* History */
    .hist-item{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:var(--card);border:1px solid var(--border);border-radius:12px;margin-bottom:8px;transition:transform .2s}
    .hist-item:active{transform:scale(.98)}
    .hist-date{font-size:.8rem;font-weight:500}
    .hist-meta{font-size:.65rem;color:var(--muted)}
    .hist-amt{font-family:monospace;font-size:1rem;font-weight:700;color:var(--accent)}
    .hist-amt.road{color:var(--blue)}.hist-amt.holiday{color:var(--gold)}
    
    /* Period Selector */
    .period-sel{display:flex;gap:8px;overflow-x:auto;padding:4px 0;margin-bottom:16px}
    .period-sel::-webkit-scrollbar{display:none}
    .period-btn{flex-shrink:0;padding:10px 14px;border-radius:10px;background:var(--card);border:1px solid var(--border);color:var(--text2);font-size:.7rem;font-weight:500;cursor:pointer;font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;transition:all .2s}
    .period-btn.active{background:var(--accent);color:var(--bg);border-color:var(--accent);transform:scale(1.05)}
    .period-btn:active{transform:scale(.95)}
    
    /* Toast */
    .toast{position:fixed;bottom:calc(100px + env(safe-area-inset-bottom));left:50%;transform:translateX(-50%) translateY(100px);background:var(--elev);border:1px solid var(--accent);border-radius:12px;padding:12px 20px;font-size:.8rem;z-index:200;opacity:0;transition:all .3s;box-shadow:0 10px 30px rgba(0,255,136,.3)}
    .toast.show{transform:translateX(-50%) translateY(0);opacity:1}
    
    /* Confetti */
    .confetti{position:fixed;width:10px;height:10px;pointer-events:none;z-index:999}
    
    /* Celebration */
    .celebration{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:4rem;pointer-events:none;z-index:999;animation:celebration 1s ease-out forwards;opacity:0}
    @keyframes celebration{0%{transform:translate(-50%,-50%) scale(0);opacity:1}50%{transform:translate(-50%,-50%) scale(1.2);opacity:1}100%{transform:translate(-50%,-50%) scale(1);opacity:0}}
</style>
```

</head>
<body data-theme="dark" data-color="green">
    <header class="header">
        <div class="logo">
            <div class="logo-icon">‚õèÔ∏è</div>
            <span class="logo-text">–í–∞—Ö—Ç–∞ Live Pro</span>
        </div>
        <div class="header-right">
            <span class="badge" id="badge">LIVE</span>
            <button class="theme-btn" id="themeBtn">üé®</button>
        </div>
    </header>

```
<div class="container">
    <!-- Dashboard -->
    <div id="tab-dash" class="tab-content active">
        <!-- XP Card -->
        <div class="xp-card">
            <div class="xp-header">
                <div>
                    <div class="xp-level" id="xpLevel">–£—Ä. 1</div>
                    <div class="xp-text" id="xpText">0 / 100 XP</div>
                </div>
                <div class="xp-avatar" id="xpAvatar">‚õèÔ∏è</div>
            </div>
            <div class="xp-bar">
                <div class="xp-fill" id="xpFill" style="width:0%"></div>
            </div>
            <div class="achievements">
                <div class="ach locked" title="–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å">üåü</div>
                <div class="ach locked" title="–ù–µ–¥–µ–ª—è –Ω–∞ –≤–∞—Ö—Ç–µ">üî•</div>
                <div class="ach locked" title="–ú–µ—Å—è—Ü –Ω–∞ –≤–∞—Ö—Ç–µ">üí™</div>
                <div class="ach locked" title="–ü–µ—Ä–≤–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞">üí∞</div>
                <div class="ach locked" title="100–∫ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ">üíé</div>
                <div class="ach locked" title="–ü–æ–ª–æ–≤–∏–Ω–∞ –≤–∞—Ö—Ç—ã">üéØ</div>
                <div class="ach locked" title="–í–∞—Ö—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞">üèÜ</div>
            </div>
            <div id="rosneftSlogan" style="display:none;margin-top:12px;padding:10px 16px;background:linear-gradient(135deg,rgba(212,175,55,.08),rgba(184,148,30,.05));border-radius:10px;border:1px solid rgba(212,175,55,.25);text-align:center;font-size:0.65rem;font-weight:600;color:#D4AF37;letter-spacing:1.5px;text-shadow:0 0 10px rgba(212,175,55,.3);">
                ‚ö° –≠–ù–ï–†–ì–ò–Ø –í–û–ó–ú–û–ñ–ù–û–°–¢–ï–ô ‚Ä¢ –£–í–ï–†–ï–ù–ù–û–°–¢–¨ –í –ë–£–î–£–©–ï–ú ‚ö°
            </div>
        </div>

        <!-- Timer Widget -->
        <div class="timer-widget" id="timerWidget" style="display:none">
            <div class="timer-head">
                <span class="timer-title">‚è∞ –î–æ –∫–æ–Ω—Ü–∞ —Å–º–µ–Ω—ã</span>
                <span id="timerToggle" style="cursor:pointer">üîî</span>
            </div>
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            <div class="timer-label">–û—Å—Ç–∞–ª–æ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å</div>
        </div>

        <!-- Live Card -->
        <div class="live-card">
            <div class="live-status">
                <div class="live-dot" id="liveDot"></div>
                <span class="live-text on" id="liveTxt">–°–ú–ï–ù–ê –ò–î–Å–¢</span>
                <span class="live-time" id="liveTime">12:34:56</span>
            </div>
            <div class="money" id="moneyContainer">
                <div class="money-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞ –≤–∞—Ö—Ç—É</div>
                <div class="money-amount">
                    <span class="money-val" id="moneyRub">0</span>
                    <span class="money-kop" id="moneyKop">.00</span>
                    <span class="money-cur">‚ÇΩ</span>
                </div>
                <div class="money-ps" id="moneyPs">+<span id="perSec">0.00</span>‚ÇΩ/—Å–µ–∫</div>
            </div>
            <div class="shift-prog" id="shiftProg">
                <div class="shift-head">
                    <span>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–º–µ–Ω—ã</span>
                    <span id="shiftHrs">0.0 / 11 —á</span>
                </div>
                <div class="prog-track"><div class="prog-fill" id="shiftFill" style="width:0%"></div></div>
                <div class="shift-labels"><span>08:00</span><span>–û–±–µ–¥</span><span>20:00</span></div>
            </div>
        </div>

        <div class="stats3">
            <div class="stat3"><div class="stat3-val" style="color:var(--accent)" id="qsToday">0‚ÇΩ</div><div class="stat3-lbl">–°–µ–≥–æ–¥–Ω—è</div></div>
            <div class="stat3"><div class="stat3-val" style="color:var(--gold)" id="qsHrs">0—á</div><div class="stat3-lbl">–ß–∞—Å–æ–≤</div></div>
            <div class="stat3"><div class="stat3-val" style="color:var(--blue)" id="qsDays">0</div><div class="stat3-lbl">–î–Ω–µ–π</div></div>
        </div>

        <!-- Salary Predictions -->
        <div class="salary-card">
            <div class="salary-head">
                <span class="salary-title">üí∏ –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞—Ä–ø–ª–∞—Ç</span>
            </div>
            <div class="salary-item">
                <div class="salary-date" id="sal10Date">10 —è–Ω–≤–∞—Ä—è 2026</div>
                <div class="salary-amount">
                    <span id="sal10">0 ‚ÇΩ</span>
                    <span class="salary-type">–û—Å–Ω–æ–≤–Ω–∞—è</span>
                </div>
                <div class="salary-countdown" id="sal10Countdown">–î–æ –≤—ã–ø–ª–∞—Ç—ã: 17 –¥–Ω–µ–π</div>
            </div>
            <div class="salary-item">
                <div class="salary-date" id="sal25Date">25 —è–Ω–≤–∞—Ä—è 2026</div>
                <div class="salary-amount">
                    <span id="sal25">0 ‚ÇΩ</span>
                    <span class="salary-type">–û—Å–Ω–æ–≤–Ω–∞—è</span>
                </div>
                <div class="salary-countdown" id="sal25Countdown">–î–æ –≤—ã–ø–ª–∞—Ç—ã: 32 –¥–Ω—è</div>
            </div>
            <div class="salary-item">
                <div class="salary-date" id="salBonusDate">10 –º–∞—Ä—Ç–∞ 2026</div>
                <div class="salary-amount">
                    <span id="salBonus">0 ‚ÇΩ</span>
                    <span class="salary-type" style="background:rgba(255,215,0,.2);color:var(--gold)">üéÅ –ü—Ä–µ–º–∏—è</span>
                </div>
                <div class="salary-countdown" id="salBonusCountdown">–ó–∞ –¥–µ–∫–∞–±—Ä—å 2025</div>
            </div>
        </div>

        <div class="card">
            <div class="card-head">
                <span class="card-title">üíµ –ó–∞ –¥–µ–Ω—å</span>
                <div class="toggle-wrap">
                    <button class="toggle-btn on" id="tgBonus">–° –ø—Ä–µ–º–∏–µ–π</button>
                    <button class="toggle-btn" id="tgNoBonus">–ë–µ–∑</button>
                </div>
            </div>
            <div id="dayBk"></div>
        </div>

        <div class="card">
            <div class="vahta-head">
                <div class="vahta-info"><h3>üìÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –≤–∞—Ö—Ç—ã</h3><div class="vahta-dates" id="vDates">-</div></div>
                <div class="vahta-pct" id="vPct">0%</div>
            </div>
            <div class="vahta-prog"><div class="vahta-fill" id="vFill" style="width:0%"></div></div>
            <div class="vahta-stats">
                <div class="vs"><div class="vs-val" style="color:var(--accent)" id="vsWork">0</div><div class="vs-lbl">–†–∞–±.</div></div>
                <div class="vs"><div class="vs-val" style="color:var(--blue)" id="vsRoad">0</div><div class="vs-lbl">–î–æ—Ä–æ–≥–∞</div></div>
                <div class="vs"><div class="vs-val" style="color:var(--gold)" id="vsHol">0</div><div class="vs-lbl">–ü—Ä–∞–∑–¥.</div></div>
                <div class="vs"><div class="vs-val" style="color:var(--orange)" id="vsLeft">0</div><div class="vs-lbl">–û—Å—Ç–∞–ª.</div></div>
            </div>
        </div>
    </div>

    <!-- Profile Tab -->
    <div id="tab-profile" class="tab-content">
        <div class="card-title" style="margin-bottom:16px">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
        
        <!-- Premium Profile Card -->
        <div class="profile-card">
            <div class="profile-bg"></div>
            <div class="profile-content">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">
                        <span id="avatarText">–í–ú</span>
                    </div>
                    <div class="profile-info">
                        <div class="profile-name" id="profileName">–í–∞—Ö—Ç–æ–≤–∏–∫</div>
                        <div class="profile-rank" id="profileRank">‚≠ê –ù–æ–≤–∏—á–æ–∫</div>
                    </div>
                    <button class="profile-edit-btn" id="btnEditProfile">‚úèÔ∏è</button>
                </div>
                <div id="streakBadge" class="profile-streak" style="display:none">
                    üî• <span id="streakValue">0</span> –¥–Ω–µ–π
                </div>
                <div class="profile-stats-grid">
                    <div class="profile-stat">
                        <div class="profile-stat-icon">üí∞</div>
                        <div class="profile-stat-label">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                        <div class="profile-stat-value" id="totalEarned">0 ‚ÇΩ</div>
                    </div>
                    <div class="profile-stat">
                        <div class="profile-stat-icon">üìÖ</div>
                        <div class="profile-stat-label">–î–Ω–µ–π –Ω–∞ –≤–∞—Ö—Ç–µ</div>
                        <div class="profile-stat-value" id="totalDays">0</div>
                    </div>
                    <div class="profile-stat">
                        <div class="profile-stat-icon">üî•</div>
                        <div class="profile-stat-label">–°–µ—Ä–∏—è –¥–Ω–µ–π</div>
                        <div class="profile-stat-value" id="streak">0</div>
                    </div>
                    <div class="profile-stat">
                        <div class="profile-stat-icon">‚ö°</div>
                        <div class="profile-stat-label">–°—Ä–µ–¥–Ω—è—è –ó–ü/–¥–µ–Ω—å</div>
                        <div class="profile-stat-value" id="avgDaily">0 ‚ÇΩ</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparison with Previous Shift -->
        <div class="card">
            <div class="card-head">
                <span class="card-title">üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –≤–∞—Ö—Ç–æ–π</span>
            </div>
            <div class="comparison-grid">
                <div class="comparison-item">
                    <div class="comparison-label">–¢–µ–∫—É—â–∞—è –≤–∞—Ö—Ç–∞</div>
                    <div class="comparison-value current" id="currentShift">0 ‚ÇΩ</div>
                </div>
                <div class="comparison-arrow">
                    <div class="comparison-change" id="changePercent">-</div>
                </div>
                <div class="comparison-item">
                    <div class="comparison-label">–ü—Ä–æ—à–ª–∞—è –≤–∞—Ö—Ç–∞</div>
                    <div class="comparison-value prev" id="prevShift">0 ‚ÇΩ</div>
                </div>
            </div>
        </div>

        <!-- Career Stats -->
        <div class="card">
            <div class="card-head">
                <span class="card-title">üìà –ö–∞—Ä—å–µ—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
            </div>
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px">
                <div style="background:var(--bg2);padding:16px;border-radius:12px;border:1px solid var(--border)">
                    <div style="font-size:0.7rem;color:var(--muted);margin-bottom:8px">–õ—É—á—à–∞—è –≤–∞—Ö—Ç–∞</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--accent)" id="bestShift">0 ‚ÇΩ</div>
                </div>
                <div style="background:var(--bg2);padding:16px;border-radius:12px;border:1px solid var(--border)">
                    <div style="font-size:0.7rem;color:var(--muted);margin-bottom:8px">–í—Å–µ–≥–æ –≤–∞—Ö—Ç</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--gold)" id="totalShifts">0</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Goals Tab -->
    <div id="tab-goals" class="tab-content">
        <div class="card-title" style="margin-bottom:16px">üéØ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ü–µ–ª–∏</div>
        
        <!-- Active Goal -->
        <div class="card" id="goalCard">
            <div class="card-head">
                <span class="card-title">üéØ –ê–∫—Ç–∏–≤–Ω–∞—è —Ü–µ–ª—å</span>
                <button class="toggle-btn" id="btnSetGoal" style="padding:4px 10px;font-size:0.65rem">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å</button>
            </div>
            <div id="goalContent">
                <div style="text-align:center;margin-bottom:16px">
                    <div style="font-size:0.7rem;color:var(--muted);margin-bottom:6px" id="goalLabel">–¶–µ–ª—å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</div>
                    <div style="font-family:monospace;font-size:2.5rem;font-weight:700;color:var(--accent);text-shadow:0 0 20px currentColor" id="goalAmount">0 ‚ÇΩ</div>
                    <div style="font-size:0.7rem;color:var(--text2);margin-top:8px" id="goalRemaining">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–µ–ª—å</div>
                </div>
                <div class="prog-track" style="height:12px">
                    <div class="prog-fill" id="goalFill" style="width:0%"></div>
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:12px;font-size:0.7rem;color:var(--muted)">
                    <span id="goalProgress">0%</span>
                    <span id="goalDaysLeft">-</span>
                </div>
            </div>
        </div>

        <!-- Goal Motivators -->
        <div class="card">
            <div class="card-head">
                <span class="card-title">üí™ –ú–æ—Ç–∏–≤–∞—Ü–∏—è</span>
            </div>
            <div style="padding:16px;background:linear-gradient(135deg,var(--accent),var(--accent2));border-radius:12px;margin-top:12px;text-align:center">
                <div style="font-size:2rem;margin-bottom:8px" id="motivIcon">üéØ</div>
                <div style="font-size:0.9rem;font-weight:600;color:var(--bg);line-height:1.4" id="motivText">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–µ–ª—å –∏ –¥–æ—Å—Ç–∏–≥–∞–π—Ç–µ –µ—ë —à–∞–≥ –∑–∞ —à–∞–≥–æ–º!</div>
            </div>
        </div>

        <!-- Quick Goals -->
        <div class="card">
            <div class="card-head">
                <span class="card-title">‚ö° –ë—ã—Å—Ç—Ä—ã–µ —Ü–µ–ª–∏</span>
            </div>
            <div style="display:grid;gap:10px;margin-top:12px">
                <button class="quick-goal-btn" data-amount="50000">
                    <span style="font-size:1.2rem">üì±</span>
                    <span>–ù–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω - 50 000‚ÇΩ</span>
                </button>
                <button class="quick-goal-btn" data-amount="100000">
                    <span style="font-size:1.2rem">üíª</span>
                    <span>–ù–æ—É—Ç–±—É–∫ - 100 000‚ÇΩ</span>
                </button>
                <button class="quick-goal-btn" data-amount="200000">
                    <span style="font-size:1.2rem">üöó</span>
                    <span>–ê–≤—Ç–æ - 200 000‚ÇΩ</span>
                </button>
                <button class="quick-goal-btn" data-amount="500000">
                    <span style="font-size:1.2rem">üè†</span>
                    <span>–ü–µ—Ä–≤—ã–π –≤–∑–Ω–æ—Å - 500 000‚ÇΩ</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Calendar -->
    <div id="tab-cal" class="tab-content">
        <div class="period-sel">
            <button class="period-btn active" data-p="current">–¢–µ–∫—É—â–∞—è –≤–∞—Ö—Ç–∞</button>
            <button class="period-btn" data-p="month">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</button>
            <button class="period-btn" data-p="year">2026 –≥–æ–¥</button>
        </div>
        <div class="stats3">
            <div class="stat3"><div class="stat3-val" style="color:var(--accent)" id="psDays">0</div><div class="stat3-lbl">–î–Ω–µ–π</div></div>
            <div class="stat3"><div class="stat3-val" style="color:var(--gold)" id="psHrs">0</div><div class="stat3-lbl">–ß–∞—Å–æ–≤</div></div>
            <div class="stat3"><div class="stat3-val" style="color:var(--blue)" id="psNet">0‚ÇΩ</div><div class="stat3-lbl">–ù–∞ —Ä—É–∫–∏</div></div>
        </div>
        <div class="cal-section">
            <div class="cal-head">
                <button class="cal-btn" id="calPrev">‚Äπ</button>
                <span class="cal-title" id="calTitle">–î–µ–∫–∞–±—Ä—å 2025</span>
                <button class="cal-btn" id="calNext">‚Ä∫</button>
            </div>
            <div class="cal-wdays"><div class="cal-wd">–ü–ù</div><div class="cal-wd">–í–¢</div><div class="cal-wd">–°–†</div><div class="cal-wd">–ß–¢</div><div class="cal-wd">–ü–¢</div><div class="cal-wd">–°–ë</div><div class="cal-wd">–í–°</div></div>
            <div class="cal-grid" id="calGrid"></div>
            <div class="cal-legend">
                <div class="leg-item"><div class="leg-dot" style="background:var(--accent)"></div>–í–∞—Ö—Ç–∞</div>
                <div class="leg-item"><div class="leg-dot" style="background:var(--gold)"></div>–ü—Ä–∞–∑–¥–Ω–∏–∫</div>
                <div class="leg-item"><div class="leg-dot" style="background:var(--blue)"></div>–î–æ—Ä–æ–≥–∞</div>
                <div class="leg-item"><div class="leg-dot" style="background:var(--red)"></div>–í—ã—Ö–æ–¥–Ω–æ–π</div>
                <div class="leg-item"><div class="leg-dot" style="background:var(--purple)"></div>–û—Ç–ø—É—Å–∫</div>
            </div>
        </div>
    </div>

    <!-- History -->
    <div id="tab-hist" class="tab-content">
        <div class="card-title" style="margin-bottom:16px">üìú –ò—Å—Ç–æ—Ä–∏—è</div>
        <div id="histList"></div>
    </div>

    <!-- Settings -->
    <div id="tab-set" class="tab-content">
        <div class="set-section">
            <div class="set-title">üé® –¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</div>
            <div class="theme-grid">
                <div class="theme-opt active" data-theme="dark">üåô –¢–µ–º–Ω–∞—è</div>
                <div class="theme-opt" data-theme="amoled">‚ö´ AMOLED</div>
                <div class="theme-opt" data-theme="rosneft">üõ¢Ô∏è –†–æ—Å–Ω–µ—Ñ—Ç—å</div>
            </div>
            <div class="set-title">üé® –ê–∫—Ü–µ–Ω—Ç–Ω—ã–π —Ü–≤–µ—Ç</div>
            <div class="theme-grid">
                <div class="theme-opt active" data-color="green">üíö –ó–µ–ª–µ–Ω—ã–π</div>
                <div class="theme-opt" data-color="blue">üíô –°–∏–Ω–∏–π</div>
                <div class="theme-opt" data-color="purple">üíú –§–∏–æ–ª–µ—Ç–æ–≤—ã–π</div>
            </div>
        </div>
        
        <div class="set-section">
            <div class="set-title">üí∞ –°—Ç–∞–≤–∫–∏</div>
            <div class="set-row"><span class="set-lbl">–ß–∞—Å–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞</span><input type="number" class="set-input" id="sHourly" value="187.94" step="0.01"></div>
            <div class="set-row"><span class="set-lbl">–ß–∞—Å–æ–≤ –≤ —Å–º–µ–Ω–µ</span><input type="number" class="set-input" id="sHours" value="11"></div>
            <div class="set-row"><span class="set-lbl">–í–∞—Ö—Ç–∞ –Ω–∞–¥–±./–¥–µ–Ω—å</span><input type="number" class="set-input" id="sVahta" value="700"></div>
            <div class="set-row"><span class="set-lbl">–í–∞—Ö—Ç–∞ —Å–≤—ã—à–µ/–¥–µ–Ω—å</span><input type="number" class="set-input" id="sVahtaEx" value="100"></div>
        </div>
        <div class="set-section">
            <div class="set-title">üìä –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (%)</div>
            <div class="set-row"><span class="set-lbl">–†–∞–π–æ–Ω–Ω—ã–π –∫–æ—ç—Ñ.</span><input type="number" class="set-input" id="sRegion" value="70"></div>
            <div class="set-row"><span class="set-lbl">–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –Ω–∞–¥–±.</span><input type="number" class="set-input" id="sPercent" value="50"></div>
            <div class="set-row"><span class="set-lbl">–î–æ–ø–ª–†–∞—Å—à–ó–æ–Ω</span><input type="number" class="set-input" id="sZone" value="10"></div>
            <div class="set-row"><span class="set-lbl">–ó–∞ —Å—Ç–∞–∂</span><input type="number" class="set-input" id="sExp" value="30"></div>
            <div class="set-row"><span class="set-lbl">–ù–î–§–õ</span><input type="number" class="set-input" id="sNdfl" value="13"></div>
        </div>
        <div class="set-section">
            <div class="set-title">üõ£Ô∏è –î–æ—Ä–æ–≥–∞</div>
            <div class="set-row"><span class="set-lbl">–ß–∞—Å–æ–≤ –¥–æ—Ä–æ–≥–∏</span><input type="number" class="set-input" id="sRoadH" value="8"></div>
        </div>
        <div class="set-section">
            <div class="set-title">üéÅ –ü—Ä–µ–º–∏—è</div>
            <div class="set-row"><span class="set-lbl">–ú–µ—Å—è—á–Ω–∞—è –ø—Ä–µ–º–∏—è</span><input type="number" class="set-input" id="sBonus" value="17857"></div>
        </div>
        <button class="save-btn" id="saveBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
</div>

<div class="edit-overlay" id="editOv">
    <div class="edit-panel">
        <div class="edit-head"><span class="edit-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</span><button class="edit-close" id="editClose">‚úï</button></div>
        <div class="edit-date" id="editDate">24 –¥–µ–∫–∞–±—Ä—è 2025</div>
        <div class="edit-grid">
            <button class="edit-btn vm" data-s="vm"><span class="edit-icon">‚õèÔ∏è</span>–í–∞—Ö—Ç–∞</button>
            <button class="edit-btn holiday" data-s="holiday"><span class="edit-icon">üéâ</span>–ü—Ä–∞–∑–¥–Ω–∏–∫</button>
            <button class="edit-btn road" data-s="road"><span class="edit-icon">üõ£Ô∏è</span>–î–æ—Ä–æ–≥–∞</button>
            <button class="edit-btn vo" data-s="vo"><span class="edit-icon">üè†</span>–í—ã—Ö–æ–¥–Ω–æ–π</button>
            <button class="edit-btn vacation" data-s="vacation"><span class="edit-icon">üèñÔ∏è</span>–û—Ç–ø—É—Å–∫</button>
            <button class="edit-btn hospital" data-s="hospital"><span class="edit-icon">üè•</span>–ë–æ–ª—å–Ω–∏—á–Ω—ã–π</button>
        </div>
    </div>
</div>

<!-- Goal Setting Overlay -->
<div class="edit-overlay" id="goalOv">
    <div class="edit-panel">
        <div class="edit-head"><span class="edit-title">üéØ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å</span><button class="edit-close" id="goalClose">‚úï</button></div>
        <div style="margin-bottom:16px">
            <label style="font-size:0.75rem;color:var(--muted);display:block;margin-bottom:8px">–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏</label>
            <input type="text" id="goalName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω" style="width:100%;padding:12px;border-radius:10px;background:var(--bg);border:1px solid var(--border);color:var(--text);font-size:0.9rem">
        </div>
        <div style="margin-bottom:16px">
            <label style="font-size:0.75rem;color:var(--muted);display:block;margin-bottom:8px">–°—É–º–º–∞ —Ü–µ–ª–∏ (‚ÇΩ)</label>
            <input type="number" id="goalTarget" placeholder="100000" style="width:100%;padding:12px;border-radius:10px;background:var(--bg);border:1px solid var(--border);color:var(--text);font-size:0.9rem;font-family:'SF Mono',monospace">
        </div>
        <button class="save-btn" id="goalSaveBtn">üíæ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å</button>
    </div>
</div>

<!-- Profile Edit Overlay -->
<div class="edit-overlay" id="profileOv">
    <div class="edit-panel">
        <div class="edit-head"><span class="edit-title">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</span><button class="edit-close" id="profileClose">‚úï</button></div>
        <div style="margin-bottom:16px">
            <label style="font-size:0.75rem;color:var(--muted);display:block;margin-bottom:8px">–í–∞—à–µ –∏–º—è</label>
            <input type="text" id="profileNameInput" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" style="width:100%;padding:12px;border-radius:10px;background:var(--bg);border:1px solid var(--border);color:var(--text);font-size:0.9rem">
        </div>
        <button class="save-btn" id="profileSaveBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active" data-t="dash"><span class="nav-icon">üí∞</span>Live</div>
    <div class="nav-item" data-t="profile"><span class="nav-icon">üë§</span>–ü—Ä–æ—Ñ–∏–ª—å</div>
    <div class="nav-item" data-t="goals"><span class="nav-icon">üéØ</span>–¶–µ–ª–∏</div>
    <div class="nav-item" data-t="cal"><span class="nav-icon">üìÖ</span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
    <div class="nav-item" data-t="hist"><span class="nav-icon">üìú</span>–ò—Å—Ç–æ—Ä–∏—è</div>
    <div class="nav-item" data-t="set"><span class="nav-icon">‚öôÔ∏è</span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
</nav>

<div class="toast" id="toast"></div>

<script>
    const MO=['–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å','–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'];
    const LB={vm:'–í–ú',vo:'–í–û',road:'–î',vacation:'–û–¢',hospital:'–ë',holiday:'–ü'};
    const DEF={hourly:187.94,hours:11,vahta:700,vahtaEx:100,region:70,percent:50,zone:10,exp:30,ndfl:13,roadH:8,bonus:17857};
    let S={...DEF},st={calY:2025,calM:11,selDay:null,period:'current',withBonus:true,xp:0,level:1,achievements:[],theme:'dark',color:'green',notifications:true,lastMoney:0,goal:{name:'',target:0,enabled:false},profile:{name:'–í–∞—Ö—Ç–æ–≤–∏–∫',totalEarned:0,totalDays:0,streak:0},prevShiftEarnings:0,tips:[]},sch={};
    let autoSaveTimer=null;

    // Smart Tips System
    const TIPS=[
        {id:'shift_start',text:'üí° –ù–∞—á–∞–ª–æ —Å–º–µ–Ω—ã! –ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ—Ç–º–µ—Ç–∏—Ç—å –¥–µ–Ω—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ',trigger:'shift_start'},
        {id:'half_done',text:'üéØ –ü–æ–ª–æ–≤–∏–Ω–∞ —Å–º–µ–Ω—ã –ø—Ä–æ–π–¥–µ–Ω–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!',trigger:'progress_50'},
        {id:'goal_close',text:'üî• –î–æ —Ü–µ–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ 10%! –§–∏–Ω–∏—à–Ω–∞—è –ø—Ä—è–º–∞—è!',trigger:'goal_90'},
        {id:'achievement',text:'‚≠ê –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å',trigger:'new_achievement'},
        {id:'payday',text:'üí∞ –°–∫–æ—Ä–æ –∑–∞—Ä–ø–ª–∞—Ç–∞! –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –±—é–¥–∂–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ',trigger:'payday_soon'}
    ];

    function showTip(tipId){
        const tip=TIPS.find(t=>t.id===tipId);
        if(!tip||st.tips.includes(tipId))return;
        st.tips.push(tipId);
        toast(tip.text,5000);
        saveState();
    }

    function autoSave(){
        clearTimeout(autoSaveTimer);
        autoSaveTimer=setTimeout(()=>{
            saveState();
            console.log('‚úÖ Auto-saved');
        },1000);
    }

    function getDefSch(){return{2025:{12:{1:'vm',2:'vm',3:'vm',4:'vm',5:'vm',6:'vm',7:'vm',8:'vm',9:'road',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'road',19:'vm',20:'vm',21:'vm',22:'vm',23:'vm',24:'vm',25:'vm',26:'vm',27:'vm',28:'vm',29:'vm',30:'vm',31:'holiday'}},2026:{1:{1:'holiday',2:'holiday',3:'holiday',4:'holiday',5:'holiday',6:'holiday',7:'holiday',8:'holiday',9:'road',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo',31:'vo'},2:{1:'vo',2:'vo',3:'vo',4:'vo',5:'vo',6:'vo',7:'vo',8:'vo',9:'road',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'vm',17:'vm',18:'vm',19:'vm',20:'vm',21:'vm',22:'vm',23:'holiday',24:'vm',25:'vm',26:'vm',27:'vm',28:'vm'},3:{1:'vm',2:'vm',3:'vm',4:'vm',5:'vm',6:'vm',7:'vm',8:'holiday',9:'road',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo',31:'vo'},4:{1:'vo',2:'vo',3:'vo',4:'vo',5:'vo',6:'vo',7:'vo',8:'vo',9:'road',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'vm',17:'vm',18:'vm',19:'vm',20:'vm',21:'vm',22:'vm',23:'vm',24:'vm',25:'vm',26:'vm',27:'vm',28:'vm',29:'vm',30:'vm'},5:{1:'holiday',2:'vm',3:'vm',4:'vm',5:'vm',6:'vm',7:'vm',8:'vm',9:'holiday',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'road',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo',31:'vo'},6:{1:'vo',2:'vo',3:'vo',4:'vo',5:'vo',6:'vo',7:'vo',8:'vacation',9:'vacation',10:'vacation',11:'vacation',12:'vacation',13:'vacation',14:'vacation',15:'vacation',16:'vacation',17:'vacation',18:'vacation',19:'vacation',20:'vacation',21:'vacation',22:'vacation',23:'vacation',24:'vacation',25:'vacation',26:'vacation',27:'vacation',28:'vacation',29:'vacation',30:'vacation'},7:{1:'vacation',2:'vacation',3:'vacation',4:'vacation',5:'vacation',6:'vacation',7:'vacation',8:'vacation',9:'vo',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo',31:'vo'},8:{1:'vo',2:'vo',3:'vo',4:'vo',5:'vo',6:'vo',7:'vo',8:'vo',9:'road',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'vm',17:'vm',18:'vm',19:'vm',20:'vm',21:'vm',22:'vm',23:'vm',24:'vm',25:'vm',26:'vm',27:'vm',28:'vm',29:'vm',30:'vm',31:'vm'},9:{1:'vm',2:'vm',3:'vm',4:'vm',5:'vm',6:'vm',7:'vm',8:'vm',9:'road',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'vm',17:'vm',18:'vm',19:'road',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo'},10:{1:'vo',2:'vo',3:'vo',4:'vo',5:'vo',6:'vo',7:'vo',8:'vo',9:'vo',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'road',31:'vm'},11:{1:'vm',2:'vm',3:'vm',4:'holiday',5:'vm',6:'vm',7:'vm',8:'vm',9:'vm',10:'vm',11:'vm',12:'vm',13:'vm',14:'vm',15:'vm',16:'vm',17:'vm',18:'vm',19:'vm',20:'vm',21:'vm',22:'vm',23:'vm',24:'vm',25:'vm',26:'vm',27:'vm',28:'vm',29:'vm',30:'road'},12:{1:'vm',2:'vm',3:'vm',4:'vm',5:'vm',6:'vm',7:'vm',8:'vm',9:'road',10:'vo',11:'vo',12:'vo',13:'vo',14:'vo',15:'vo',16:'vo',17:'vo',18:'vo',19:'vo',20:'vo',21:'vo',22:'vo',23:'vo',24:'vo',25:'vo',26:'vo',27:'vo',28:'vo',29:'vo',30:'vo',31:'vo'}}};}
    
    function loadSch(){const s=localStorage.getItem('vsch2');sch=s?JSON.parse(s):getDefSch();}
    function saveSch(){localStorage.setItem('vsch2',JSON.stringify(sch));}
    function getSt(y,m,d){return sch[y]?.[m]?.[d]||null;}
    function setSt(y,m,d,v){if(!sch[y])sch[y]={};if(!sch[y][m])sch[y][m]={};if(v==='clear')delete sch[y][m][d];else sch[y][m][d]=v;saveSch();}

    function calcDay(hrs,isHol,withB){
        const base=S.hourly*hrs;
        const region=base*(S.region/100);
        const percent=base*(S.percent/100);
        const zone=base*(S.zone/100);
        const exp=base*(S.exp/100);
        const vahta=S.vahta;
        const vahtaEx=S.vahtaEx;
        const holEx=isHol?base:0;
        const bonus=withB?(S.bonus/23):0;
        const gross=base+region+percent+zone+exp+vahta+vahtaEx+holEx+bonus;
        const ndfl=gross*(S.ndfl/100);
        return{base,region,percent,zone,exp,vahta,vahtaEx,holEx,bonus,gross,ndfl,net:gross-ndfl,hrs};
    }
    
    function calcRoad(){
        const hrs=S.roadH;
        const base=S.hourly*hrs;
        const region=base*(S.region/100);
        const percent=base*(S.percent/100);
        const zone=base*(S.zone/100);
        const exp=base*(S.exp/100);
        const gross=base+region+percent+zone+exp;
        const ndfl=gross*(S.ndfl/100);
        return{base,region,percent,zone,exp,gross,ndfl,net:gross-ndfl,hrs};
    }
    
    function calcPeriod(start,end,withB){
        let r={workDays:0,roadDays:0,holidays:0,hours:0,base:0,region:0,percent:0,zone:0,exp:0,vahta:0,vahtaEx:0,holEx:0,bonus:0,road:0,gross:0,ndfl:0,net:0};
        const cur=new Date(start);
        while(cur<=end){
            const y=cur.getFullYear(),m=cur.getMonth()+1,d=cur.getDate();
            const s=getSt(y,m,d);
            if(s==='vm'){r.workDays++;const day=calcDay(S.hours,false,withB);r.hours+=day.hrs;r.base+=day.base;r.region+=day.region;r.percent+=day.percent;r.zone+=day.zone;r.exp+=day.exp;r.vahta+=day.vahta;r.vahtaEx+=day.vahtaEx;r.bonus+=day.bonus;r.gross+=day.gross;r.ndfl+=day.ndfl;r.net+=day.net;}
            else if(s==='holiday'){r.holidays++;r.workDays++;const day=calcDay(S.hours,true,withB);r.hours+=day.hrs;r.base+=day.base;r.region+=day.region;r.percent+=day.percent;r.zone+=day.zone;r.exp+=day.exp;r.vahta+=day.vahta;r.vahtaEx+=day.vahtaEx;r.holEx+=day.holEx;r.bonus+=day.bonus;r.gross+=day.gross;r.ndfl+=day.ndfl;r.net+=day.net;}
            else if(s==='road'){r.roadDays++;const day=calcRoad();r.hours+=day.hrs;r.road+=day.gross;r.gross+=day.gross;r.ndfl+=day.ndfl;r.net+=day.net;}
            cur.setDate(cur.getDate()+1);
        }
        return r;
    }
    
    function findVahta(){
        const today=new Date();let start=new Date(today),end=new Date(today);
        for(let i=0;i<60;i++){const c=new Date(start);c.setDate(c.getDate()-1);const s=getSt(c.getFullYear(),c.getMonth()+1,c.getDate());if(s==='vm'||s==='road'||s==='holiday')start=c;else break;}
        for(let i=0;i<60;i++){const c=new Date(end);c.setDate(c.getDate()+1);const s=getSt(c.getFullYear(),c.getMonth()+1,c.getDate());if(s==='vm'||s==='road'||s==='holiday')end=c;else break;}
        return{start,end};
    }
    
    function getShiftProg(){const n=new Date();const h=n.getHours()+n.getMinutes()/60+n.getSeconds()/3600;if(h<8)return 0;if(h>=20)return S.hours;let w=h-8;if(h>=14)w-=1;else if(h>=13)w=5;return Math.max(0,Math.min(w,S.hours));}
    
    function fmt(n){return Math.round(n).toLocaleString('ru-RU');}
    function fmtD(d){return d.toLocaleDateString('ru-RU',{day:'numeric',month:'long'});}
    
    function toast(m,duration=2000){
        const t=document.getElementById('toast');
        t.textContent=m;
        t.classList.add('show');
        setTimeout(()=>t.classList.remove('show'),duration);
    }
    
    function celebrate(emoji){
        const c=document.createElement('div');
        c.className='celebration';
        c.textContent=emoji;
        document.body.appendChild(c);
        setTimeout(()=>c.remove(),1000);
    }
    
    function confetti(){
        const colors=['#00ff88','#ffd700','#0a84ff','#bf5af2','#ff453a'];
        for(let i=0;i<30;i++){
            setTimeout(()=>{
                const c=document.createElement('div');
                c.className='confetti';
                c.style.left=Math.random()*100+'%';
                c.style.top='0';
                c.style.background=colors[Math.floor(Math.random()*colors.length)];
                c.style.transform=`rotate(${Math.random()*360}deg)`;
                document.body.appendChild(c);
                const anim=c.animate([
                    {transform:`translate(0,0) rotate(0deg)`,opacity:1},
                    {transform:`translate(${(Math.random()-.5)*200}px,${window.innerHeight}px) rotate(${Math.random()*720}deg)`,opacity:0}
                ],{duration:2000+Math.random()*1000,easing:'cubic-bezier(.25,.46,.45,.94)'});
                anim.onfinish=()=>c.remove();
            },i*50);
        }
    }
    
    function addXP(amount,reason){
        st.xp+=amount;
        const xpForLevel=st.level*100;
        if(st.xp>=xpForLevel){
            st.xp-=xpForLevel;
            st.level++;
            celebrate('üéâ');
            confetti();
            vibrate([100,50,100,50,200]); // Haptic feedback
            toast(`üéâ –£—Ä–æ–≤–µ–Ω—å ${st.level}! ${reason}`,3000);
            showTip('achievement');
        }else{
            vibrate([50]); // Short vibration
            toast(`+${amount} XP - ${reason}`);
        }
        autoSave(); // Auto-save progress
        updateXP();
    }
    
    function vibrate(pattern){
        if('vibrate' in navigator){
            navigator.vibrate(pattern);
        }
    }
    
    function updateXP(){
        const xpForLevel=st.level*100;
        const pct=(st.xp/xpForLevel)*100;
        document.getElementById('xpLevel').textContent=`–£—Ä. ${st.level}`;
        document.getElementById('xpText').textContent=`${st.xp} / ${xpForLevel} XP`;
        document.getElementById('xpFill').style.width=pct+'%';
        
        const avatars=['‚õèÔ∏è','üí™','üî•','‚ö°','üíé','üëë','üèÜ'];
        const avatarIdx=Math.min(Math.floor(st.level/5),avatars.length-1);
        document.getElementById('xpAvatar').textContent=avatars[avatarIdx];
        
        updateAchievements();
    }
    
    function updateAchievements(){
        const vahta=findVahta();
        const totalData=calcPeriod(vahta.start,vahta.end,true);
        const achs=document.querySelectorAll('.ach');
        
        if(totalData.workDays>=1)achs[0].classList.remove('locked');
        if(totalData.workDays>=7)achs[1].classList.remove('locked');
        if(totalData.workDays>=30)achs[2].classList.remove('locked');
        if(totalData.net>=50000)achs[3].classList.remove('locked');
        if(totalData.net>=100000)achs[4].classList.remove('locked');
        
        const totalDays=Math.ceil((vahta.end-vahta.start)/86400000)+1;
        const passedDays=Math.ceil((new Date()-vahta.start)/86400000);
        if(passedDays>=totalDays/2)achs[5].classList.remove('locked');
        if(passedDays>=totalDays)achs[6].classList.remove('locked');
    }
    
    function spawnMoneyParticle(){
        const container=document.getElementById('moneyContainer');
        const particle=document.createElement('div');
        particle.className='money-particle';
        particle.textContent='üí∞';
        particle.style.left=Math.random()*100+'%';
        container.appendChild(particle);
        setTimeout(()=>particle.remove(),3000);
    }
    
    function updateTimer(){
        const now=new Date();
        const y=now.getFullYear(),m=now.getMonth()+1,d=now.getDate();
        const status=getSt(y,m,d);
        const widget=document.getElementById('timerWidget');
        
        if(status==='vm'||status==='holiday'){
            const prog=getShiftProg();
            if(prog>0&&prog<S.hours){
                widget.style.display='block';
                const endTime=new Date();
                endTime.setHours(20,0,0,0);
                if(prog<5)endTime.setHours(14,0,0,0);
                const diff=Math.max(0,endTime-now);
                const h=Math.floor(diff/3600000);
                const min=Math.floor((diff%3600000)/60000);
                const sec=Math.floor((diff%60000)/1000);
                document.getElementById('timerDisplay').textContent=
                    `${h.toString().padStart(2,'0')}:${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
                
                if(st.notifications&&diff<=0&&!st.notified){
                    celebrate('üéä');
                    toast('üéä –°–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!');
                    confetti();
                    addXP(50,'–°–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                    st.notified=true;
                    saveState();
                }
            }else{
                widget.style.display='none';
                st.notified=false;
            }
        }else{
            widget.style.display='none';
        }
    }
    
    function calculateSalaries(){
        const now=new Date();
        const currentMonth=now.getMonth();
        const currentYear=now.getFullYear();
        
        // Next 10th
        let next10=new Date(currentYear,currentMonth,10);
        if(now.getDate()>=10)next10.setMonth(next10.getMonth()+1);
        
        // Next 25th
        let next25=new Date(currentYear,currentMonth,25);
        if(now.getDate()>=25)next25.setMonth(next25.getMonth()+1);
        
        // Calculate salary for period
        const period10Start=new Date(next10);
        period10Start.setMonth(period10Start.getMonth()-1);
        period10Start.setDate(26);
        const period10End=new Date(next10);
        period10End.setDate(9);
        
        const period25Start=new Date(next25);
        period25Start.setDate(10);
        const period25End=new Date(next25);
        period25End.setDate(25);
        
        const sal10Data=calcPeriod(period10Start,period10End,false);
        const sal25Data=calcPeriod(period25Start,period25End,false);
        
        // Bonus (2 months delay)
        const bonusMonth=new Date(currentYear,currentMonth-2,1);
        const bonusMonthEnd=new Date(bonusMonth);
        bonusMonthEnd.setMonth(bonusMonthEnd.getMonth()+1);
        bonusMonthEnd.setDate(0);
        const bonusData=calcPeriod(bonusMonth,bonusMonthEnd,false);
        const bonusAmount=(bonusData.workDays/23)*S.bonus;
        
        let bonusDate=new Date(currentYear,currentMonth+2,10);
        if(now.getMonth()>=11)bonusDate.setFullYear(bonusDate.getFullYear()+1);
        
        // Update UI
        document.getElementById('sal10Date').textContent=next10.toLocaleDateString('ru-RU',{day:'numeric',month:'long',year:'numeric'});
        document.getElementById('sal10').textContent=fmt(sal10Data.net)+' ‚ÇΩ';
        const days10=Math.ceil((next10-now)/86400000);
        document.getElementById('sal10Countdown').textContent=`–î–æ –≤—ã–ø–ª–∞—Ç—ã: ${days10} ${days10%10===1&&days10!==11?'–¥–µ–Ω—å':days10%10>=2&&days10%10<=4&&(days10<10||days10>=20)?'–¥–Ω—è':'–¥–Ω–µ–π'}`;
        
        document.getElementById('sal25Date').textContent=next25.toLocaleDateString('ru-RU',{day:'numeric',month:'long',year:'numeric'});
        document.getElementById('sal25').textContent=fmt(sal25Data.net)+' ‚ÇΩ';
        const days25=Math.ceil((next25-now)/86400000);
        document.getElementById('sal25Countdown').textContent=`–î–æ –≤—ã–ø–ª–∞—Ç—ã: ${days25} ${days25%10===1&&days25!==11?'–¥–µ–Ω—å':days25%10>=2&&days25%10<=4&&(days25<10||days25>=20)?'–¥–Ω—è':'–¥–Ω–µ–π'}`;
        
        document.getElementById('salBonusDate').textContent=bonusDate.toLocaleDateString('ru-RU',{day:'numeric',month:'long',year:'numeric'});
        document.getElementById('salBonus').textContent=fmt(bonusAmount)+' ‚ÇΩ';
        document.getElementById('salBonusCountdown').textContent=`–ó–∞ ${MO[bonusMonth.getMonth()]} ${bonusMonth.getFullYear()}`;
    }
    
    function updateLive(){
        const now=new Date();const y=now.getFullYear(),m=now.getMonth()+1,d=now.getDate();
        const status=getSt(y,m,d);
        document.getElementById('liveTime').textContent=now.toLocaleTimeString('ru-RU');
        const dot=document.getElementById('liveDot'),txt=document.getElementById('liveTxt'),badge=document.getElementById('badge');

        if(status==='vm'||status==='holiday'){
            const prog=getShiftProg();const isHol=status==='holiday';
            if(isHol){dot.className='live-dot holiday';txt.className='live-text holiday';txt.textContent='–ü–†–ê–ó–î–ù–ò–ö x2';badge.textContent='x2';badge.style.background='rgba(255,215,0,.2)';badge.style.color='#ffd700';}
            else if(prog>0&&prog<S.hours){dot.className='live-dot';txt.className='live-text on';txt.textContent='–°–ú–ï–ù–ê –ò–î–Å–¢';badge.textContent='LIVE';badge.style.background='';badge.style.color='';}
            else if(prog>=S.hours){dot.className='live-dot off';txt.className='live-text off';txt.textContent='–°–ú–ï–ù–ê –ó–ê–í–ï–†–®–ï–ù–ê';badge.textContent='‚úì';}
            else{dot.className='live-dot';txt.className='live-text on';txt.textContent='–†–ê–ë–û–ß–ò–ô –î–ï–ù–¨';badge.textContent='–°–ú–ï–ù–ê';}
            document.getElementById('shiftProg').style.display='block';
            document.getElementById('shiftHrs').textContent=`${prog.toFixed(1)} / ${S.hours} —á`;
            document.getElementById('shiftFill').style.width=`${(prog/S.hours)*100}%`;
        }else if(status==='road'){
            dot.className='live-dot road';txt.className='live-text road';txt.textContent='–î–ï–ù–¨ –î–û–†–û–ì–ò';badge.textContent='üõ£Ô∏è';
            document.getElementById('shiftProg').style.display='none';
        }else{
            dot.className='live-dot off';txt.className='live-text off';txt.textContent=status==='vacation'?'–û–¢–ü–£–°–ö':'–í–´–•–û–î–ù–û–ô';badge.textContent=status==='vacation'?'üèñÔ∏è':'üè†';
            document.getElementById('shiftProg').style.display='none';
        }

        const vahta=findVahta();const yesterday=new Date(now);yesterday.setDate(yesterday.getDate()-1);yesterday.setHours(23,59,59);
        const pastData=calcPeriod(vahta.start,yesterday,st.withBonus);
        let todayEarned=0,perSec=0;
        if(status==='vm'||status==='holiday'){
            const prog=getShiftProg();const isHol=status==='holiday';
            const dayFull=calcDay(S.hours,isHol,st.withBonus);
            const rateH=dayFull.net/S.hours;const rateS=rateH/3600;
            todayEarned=rateH*prog;perSec=prog>0&&prog<S.hours?rateS:0;
        }else if(status==='road'){todayEarned=calcRoad().net;}

        const total=pastData.net+todayEarned;
        
        // Animated money counter
        if(Math.abs(total-st.lastMoney)>10){
            const moneyVal=document.getElementById('moneyRub');
            moneyVal.classList.add('counting');
            setTimeout(()=>moneyVal.classList.remove('counting'),500);
            
            if(Math.random()<0.1)spawnMoneyParticle();
        }
        st.lastMoney=total;
        
        const rub=Math.floor(total);const kop=Math.round((total-rub)*100);
        document.getElementById('moneyRub').textContent=fmt(rub);
        document.getElementById('moneyKop').textContent='.'+kop.toString().padStart(2,'0');
        document.getElementById('perSec').textContent=perSec.toFixed(4);
        document.getElementById('moneyPs').style.display=perSec>0?'block':'none';

        document.getElementById('qsToday').textContent=fmt(todayEarned)+'‚ÇΩ';
        document.getElementById('qsHrs').textContent=Math.round(pastData.hours+(status==='vm'||status==='holiday'?getShiftProg():0))+'—á';
        document.getElementById('qsDays').textContent=pastData.workDays+(status==='vm'||status==='holiday'?1:0);

        const totalDays=Math.ceil((vahta.end-vahta.start)/86400000)+1;
        const passedDays=Math.ceil((now-vahta.start)/86400000);
        const pct=Math.min(100,(passedDays/totalDays)*100);
        document.getElementById('vDates').textContent=`${fmtD(vahta.start)} ‚Äî ${fmtD(vahta.end)}`;
        document.getElementById('vPct').textContent=Math.round(pct)+'%';
        document.getElementById('vFill').style.width=pct+'%';
        document.getElementById('vsWork').textContent=pastData.workDays;
        document.getElementById('vsRoad').textContent=pastData.roadDays;
        document.getElementById('vsHol').textContent=pastData.holidays;
        document.getElementById('vsLeft').textContent=Math.max(0,totalDays-passedDays);
        
        updateTimer();
        calculateSalaries();
        updateGoal();
        updateProfile();
        updateComparison();
        
        // Check smart tips (pct already declared above)
        if(pct>=50&&pct<55&&!st.tips.includes('half_done'))showTip('half_done');
    }

    function updateDayBk(){
        const day=calcDay(S.hours,false,st.withBonus);
        let h=`<div class="bk-row"><span class="bk-lbl">–û–∫–ª–∞–¥ (${S.hours}—á √ó ${S.hourly}‚ÇΩ)</span><span class="bk-val">${fmt(day.base)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–†–∞–π–æ–Ω–Ω—ã–π –∫–æ—ç—Ñ.<span class="bk-pct">${S.region}%</span></span><span class="bk-val">${fmt(day.region)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –Ω–∞–¥–±.<span class="bk-pct">${S.percent}%</span></span><span class="bk-val">${fmt(day.percent)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–î–æ–ø–ª–†–∞—Å—à–ó–æ–Ω<span class="bk-pct">${S.zone}%</span></span><span class="bk-val">${fmt(day.zone)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–ó–∞ —Å—Ç–∞–∂<span class="bk-pct">${S.exp}%</span></span><span class="bk-val">${fmt(day.exp)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–í–∞—Ö—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥</span><span class="bk-val">${fmt(day.vahta)}‚ÇΩ</span></div>
        <div class="bk-row"><span class="bk-lbl">–í–∞—Ö—Ç. —Å–≤—ã—à–µ</span><span class="bk-val">${fmt(day.vahtaEx)}‚ÇΩ</span></div>`;
        if(st.withBonus)h+=`<div class="bk-row hl"><span class="bk-lbl">üéÅ –ü—Ä–µ–º–∏—è</span><span class="bk-val" style="color:var(--gold)">${fmt(day.bonus)}‚ÇΩ</span></div>`;
        h+=`<div class="bk-row"><span class="bk-lbl">–ù–î–§–õ<span class="bk-pct">${S.ndfl}%</span></span><span class="bk-val" style="color:var(--red)">-${fmt(day.ndfl)}‚ÇΩ</span></div>
        <div class="bk-row total"><span class="bk-lbl">üíµ –ù–∞ —Ä—É–∫–∏</span><span class="bk-val">${fmt(day.net)}‚ÇΩ</span></div>`;
        document.getElementById('dayBk').innerHTML=h;
    }

    function renderCal(){
        const y=st.calY,m=st.calM;document.getElementById('calTitle').textContent=`${MO[m]} ${y}`;
        const first=new Date(y,m,1),last=new Date(y,m+1,0),startWd=(first.getDay()+6)%7,today=new Date();
        let h='';for(let i=0;i<startWd;i++)h+='<div class="cal-day empty"></div>';
        for(let d=1;d<=last.getDate();d++){
            const s=getSt(y,m+1,d);let cls='cal-day',lbl='';
            if(s){cls+=' '+s;lbl=LB[s]||'';}
            if(d===today.getDate()&&m===today.getMonth()&&y===today.getFullYear())cls+=' today';
            if(new Date(y,m,d)<new Date(today.getFullYear(),today.getMonth(),today.getDate()))cls+=' past';
            h+=`<div class="${cls}" data-d="${d}"><span class="cal-day-num">${d}</span>${lbl?`<span class="cal-day-lbl">${lbl}</span>`:''}</div>`;
        }
        document.getElementById('calGrid').innerHTML=h;
        document.querySelectorAll('.cal-day:not(.empty)').forEach(el=>el.addEventListener('click',()=>{
            openEdit(parseInt(el.dataset.d));
            addXP(5,'–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è');
        }));
        updatePeriodStats();
    }

    function updatePeriodStats(){
        let start,end;const now=new Date();
        switch(st.period){
            case'current':const v=findVahta();start=v.start;end=v.end;break;
            case'month':start=new Date(now.getFullYear(),now.getMonth(),1);end=new Date(now.getFullYear(),now.getMonth()+1,0);break;
            case'year':start=new Date(2026,0,1);end=new Date(2026,11,31);break;
        }
        const data=calcPeriod(start,end,st.withBonus);
        document.getElementById('psDays').textContent=data.workDays;
        document.getElementById('psHrs').textContent=Math.round(data.hours);
        document.getElementById('psNet').textContent=fmt(data.net)+'‚ÇΩ';
    }

    function renderHist(){
        const html=[];const today=new Date();
        for(let i=0;i<60;i++){
            const d=new Date(today);d.setDate(d.getDate()-i);
            const s=getSt(d.getFullYear(),d.getMonth()+1,d.getDate());
            if(s==='vm'){const day=calcDay(S.hours,false,st.withBonus);html.push(`<div class="hist-item"><div><div class="hist-date">${d.toLocaleDateString('ru-RU',{day:'numeric',month:'short',weekday:'short'})}</div><div class="hist-meta">${S.hours}—á ‚Ä¢ –í–∞—Ö—Ç–∞</div></div><span class="hist-amt">+${fmt(day.net)}‚ÇΩ</span></div>`);}
            else if(s==='holiday'){const day=calcDay(S.hours,true,st.withBonus);html.push(`<div class="hist-item"><div><div class="hist-date">${d.toLocaleDateString('ru-RU',{day:'numeric',month:'short',weekday:'short'})}</div><div class="hist-meta">${S.hours}—á ‚Ä¢ –ü—Ä–∞–∑–¥–Ω–∏–∫</div></div><span class="hist-amt holiday">+${fmt(day.net)}‚ÇΩ</span></div>`);}
            else if(s==='road'){const day=calcRoad();html.push(`<div class="hist-item"><div><div class="hist-date">${d.toLocaleDateString('ru-RU',{day:'numeric',month:'short',weekday:'short'})}</div><div class="hist-meta">${S.roadH}—á ‚Ä¢ –î–æ—Ä–æ–≥–∞</div></div><span class="hist-amt road">+${fmt(day.net)}‚ÇΩ</span></div>`);}
        }
        document.getElementById('histList').innerHTML=html.length?html.join(''):'<p style="color:var(--muted);text-align:center;padding:40px 0">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</p>';
    }

    function openEdit(day){
        st.selDay={y:st.calY,m:st.calM+1,d:day};
        document.getElementById('editDate').textContent=new Date(st.calY,st.calM,day).toLocaleDateString('ru-RU',{day:'numeric',month:'long',year:'numeric',weekday:'long'});
        document.getElementById('editOv').classList.add('show');
    }

    function loadSet(){
        const s=localStorage.getItem('vset2');if(s)S={...DEF,...JSON.parse(s)};
        document.getElementById('sHourly').value=S.hourly;document.getElementById('sHours').value=S.hours;
        document.getElementById('sVahta').value=S.vahta;document.getElementById('sVahtaEx').value=S.vahtaEx;
        document.getElementById('sRegion').value=S.region;document.getElementById('sPercent').value=S.percent;
        document.getElementById('sZone').value=S.zone;document.getElementById('sExp').value=S.exp;
        document.getElementById('sNdfl').value=S.ndfl;document.getElementById('sRoadH').value=S.roadH;
        document.getElementById('sBonus').value=S.bonus;
    }

    function saveSet(){
        S.hourly=parseFloat(document.getElementById('sHourly').value)||DEF.hourly;
        S.hours=parseFloat(document.getElementById('sHours').value)||DEF.hours;
        S.vahta=parseFloat(document.getElementById('sVahta').value)||DEF.vahta;
        S.vahtaEx=parseFloat(document.getElementById('sVahtaEx').value)||DEF.vahtaEx;
        S.region=parseFloat(document.getElementById('sRegion').value)||DEF.region;
        S.percent=parseFloat(document.getElementById('sPercent').value)||DEF.percent;
        S.zone=parseFloat(document.getElementById('sZone').value)||DEF.zone;
        S.exp=parseFloat(document.getElementById('sExp').value)||DEF.exp;
        S.ndfl=parseFloat(document.getElementById('sNdfl').value)||DEF.ndfl;
        S.roadH=parseFloat(document.getElementById('sRoadH').value)||DEF.roadH;
        S.bonus=parseFloat(document.getElementById('sBonus').value)||DEF.bonus;
        localStorage.setItem('vset2',JSON.stringify(S));
        celebrate('‚úÖ');
        toast('‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
        updateLive();updateDayBk();
    }
    
    function loadState(){
        const s=localStorage.getItem('vstate');
        if(s){
            const loaded=JSON.parse(s);
            st={...st,...loaded};
            // Ensure tips array exists
            if(!st.tips)st.tips=[];
        }
    }
    
    function saveState(){
        localStorage.setItem('vstate',JSON.stringify(st));
    }
    
    // Profile functions
    function updateProfile(){
        const vahta=findVahta();
        const totalData=calcPeriod(vahta.start,vahta.end,st.withBonus);
        
        // Update name and avatar
        document.getElementById('profileName').textContent=st.profile.name;
        const initials=st.profile.name.split(' ').map(n=>n[0]).join('').toUpperCase().slice(0,2);
        document.getElementById('avatarText').textContent=initials;
        
        // Calculate rank based on level
        let rank='‚≠ê –ù–æ–≤–∏—á–æ–∫';
        if(st.level>=20)rank='üëë –õ–µ–≥–µ–Ω–¥–∞';
        else if(st.level>=15)rank='üíé –ú–∞—Å—Ç–µ—Ä';
        else if(st.level>=10)rank='üî• –≠–∫—Å–ø–µ—Ä—Ç';
        else if(st.level>=5)rank='‚ö° –ü—Ä–æ—Ñ–∏';
        document.getElementById('profileRank').textContent=rank;
        
        // Show streak badge if > 3 days
        if(st.profile.streak>3){
            document.getElementById('streakBadge').style.display='block';
            document.getElementById('streakValue').textContent=st.profile.streak;
        }else{
            document.getElementById('streakBadge').style.display='none';
        }
        
        // Update stats
        document.getElementById('totalEarned').textContent=fmt(st.profile.totalEarned)+' ‚ÇΩ';
        document.getElementById('totalDays').textContent=st.profile.totalDays;
        document.getElementById('streak').textContent=st.profile.streak;
        const avgDaily=st.profile.totalDays>0?st.profile.totalEarned/st.profile.totalDays:0;
        document.getElementById('avgDaily').textContent=fmt(Math.round(avgDaily))+' ‚ÇΩ';
        
        // Update career stats
        const bestShift=st.prevShiftEarnings||0;
        document.getElementById('bestShift').textContent=fmt(Math.round(bestShift))+' ‚ÇΩ';
        const totalShifts=Math.floor(st.profile.totalDays/30)||0;
        document.getElementById('totalShifts').textContent=totalShifts;
    }
    
    function updateComparison(){
        const vahta=findVahta();
        const currentData=calcPeriod(vahta.start,vahta.end,st.withBonus);
        document.getElementById('currentShift').textContent=fmt(currentData.net)+' ‚ÇΩ';
        document.getElementById('prevShift').textContent=fmt(st.prevShiftEarnings)+' ‚ÇΩ';
        
        if(st.prevShiftEarnings>0){
            const change=((currentData.net-st.prevShiftEarnings)/st.prevShiftEarnings)*100;
            const changeEl=document.getElementById('changePercent');
            if(change>0){
                changeEl.textContent='+'+Math.round(change)+'%';
                changeEl.className='comparison-change up';
            }else if(change<0){
                changeEl.textContent=Math.round(change)+'%';
                changeEl.className='comparison-change down';
            }else{
                changeEl.textContent='0%';
                changeEl.className='comparison-change';
            }
        }else{
            document.getElementById('changePercent').textContent='-';
            document.getElementById('changePercent').className='comparison-change';
        }
    }
    
    // Goal functions
    function updateGoal(){
        if(!st.goal.enabled||!st.goal.target){
            document.getElementById('goalLabel').textContent='–¶–µ–ª—å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞';
            document.getElementById('goalAmount').textContent='0 ‚ÇΩ';
            document.getElementById('goalRemaining').textContent='–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–µ–ª—å';
            document.getElementById('goalFill').style.width='0%';
            document.getElementById('goalProgress').textContent='0%';
            document.getElementById('goalDaysLeft').textContent='-';
            document.getElementById('motivIcon').textContent='üéØ';
            document.getElementById('motivText').textContent='–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–µ–ª—å –∏ –¥–æ—Å—Ç–∏–≥–∞–π—Ç–µ –µ—ë —à–∞–≥ –∑–∞ —à–∞–≥–æ–º!';
            return;
        }
        const vahta=findVahta();
        const now=new Date();
        const yesterday=new Date(now);yesterday.setDate(yesterday.getDate()-1);yesterday.setHours(23,59,59);
        const data=calcPeriod(vahta.start,yesterday,st.withBonus);
        let todayEarned=0;
        const y=now.getFullYear(),m=now.getMonth()+1,d=now.getDate();
        const status=getSt(y,m,d);
        if(status==='vm'||status==='holiday'){
            const prog=getShiftProg();
            const dayFull=calcDay(S.hours,status==='holiday',st.withBonus);
            todayEarned=(dayFull.net/S.hours)*prog;
        }else if(status==='road'){todayEarned=calcRoad().net;}
        const total=data.net+todayEarned;
        const pct=Math.min(100,(total/st.goal.target)*100);
        const remaining=Math.max(0,st.goal.target-total);
        const daysLeft=Math.ceil((vahta.end-now)/86400000);
        document.getElementById('goalLabel').textContent=st.goal.name||'–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª—å';
        document.getElementById('goalAmount').textContent=fmt(st.goal.target)+' ‚ÇΩ';
        document.getElementById('goalRemaining').textContent=pct>=100?'‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!':'–û—Å—Ç–∞–ª–æ—Å—å: '+fmt(remaining)+' ‚ÇΩ';
        document.getElementById('goalFill').style.width=pct+'%';
        document.getElementById('goalProgress').textContent=Math.round(pct)+'%';
        document.getElementById('goalDaysLeft').textContent=daysLeft+' –¥–Ω–µ–π –¥–æ –∫–æ–Ω—Ü–∞ –≤–∞—Ö—Ç—ã';
        
        // Update motivation
        let motivIcon='üí™',motivText='–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        if(pct>=100){motivIcon='üéâ';motivText='–¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞! –í—ã –º–æ–ª–æ–¥–µ—Ü!';}
        else if(pct>=75){motivIcon='üî•';motivText='–û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º —á—É—Ç—å-—á—É—Ç—å! –í—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏!';}
        else if(pct>=50){motivIcon='üí™';motivText='–ü–æ–ª–æ–≤–∏–Ω–∞ –ø—É—Ç–∏ –ø—Ä–æ–π–¥–µ–Ω–∞! –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!';}
        else if(pct>=25){motivIcon='‚ö°';motivText='–û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å!';}
        else{motivIcon='üéØ';motivText='–ù–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! –ö–∞–∂–¥—ã–π —Ä—É–±–ª—å –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –∫ —Ü–µ–ª–∏!';}
        document.getElementById('motivIcon').textContent=motivIcon;
        document.getElementById('motivText').textContent=motivText;
        
        // Smart tip for goal progress
        if(pct>=90&&pct<100&&!st.tips.includes('goal_close'))showTip('goal_close');
        
        if(pct>=100&&!st.achievements.includes('goal')){
            st.achievements.push('goal');
            addXP(200,'–¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!');
            celebrate('üéØ');
            confetti();
        }
    }
    
    
    function applyTheme(){
        document.body.setAttribute('data-theme',st.theme);
        document.body.setAttribute('data-color',st.color);
        
        // Update logo for Rosneft theme
        const logoIcon = document.querySelector('.logo-icon');
        const logoText = document.querySelector('.logo-text');
        const rosneftSlogan = document.getElementById('rosneftSlogan');
        
        if(st.theme === 'rosneft'){
            logoIcon.textContent = 'üõ¢Ô∏è';
            logoText.innerHTML = '–†–û–°–ù–ï–§–¢–¨<br><span style="font-size:0.5em;opacity:0.8">–í–ê–•–¢–ê PRO</span>';
            logoText.style.lineHeight = '1.2';
            if(rosneftSlogan) rosneftSlogan.style.display = 'block';
        } else {
            logoIcon.textContent = '‚õèÔ∏è';
            logoText.textContent = '–í–∞—Ö—Ç–∞ Live Pro';
            logoText.style.lineHeight = '';
            if(rosneftSlogan) rosneftSlogan.style.display = 'none';
        }
        
        document.querySelectorAll('.theme-opt[data-theme]').forEach(el=>{
            el.classList.toggle('active',el.dataset.theme===st.theme);
        });
        document.querySelectorAll('.theme-opt[data-color]').forEach(el=>{
            el.classList.toggle('active',el.dataset.color===st.color);
        });
    }

    // Setup Event Listeners
    function setupEventListeners(){
    // Event Listeners
    document.querySelectorAll('.nav-item').forEach(i=>i.addEventListener('click',function(){
        const t=this.dataset.t;
        document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
        this.classList.add('active');document.getElementById('tab-'+t).classList.add('active');
        if(t==='cal')renderCal();if(t==='hist')renderHist();
    }));
    
    document.getElementById('calPrev').addEventListener('click',()=>{st.calM--;if(st.calM<0){st.calM=11;st.calY--;}if(st.calY<2025){st.calY=2025;st.calM=0;}renderCal();});
    document.getElementById('calNext').addEventListener('click',()=>{st.calM++;if(st.calM>11){st.calM=0;st.calY++;}if(st.calY>2027){st.calY=2027;st.calM=11;}renderCal();});
    
    document.querySelectorAll('.period-btn').forEach(b=>b.addEventListener('click',function(){
        st.period=this.dataset.p;
        document.querySelectorAll('.period-btn').forEach(x=>x.classList.remove('active'));
        this.classList.add('active');
        updatePeriodStats();
    }));
    
    document.getElementById('tgBonus').addEventListener('click',function(){
        st.withBonus=true;
        this.classList.add('on');
        document.getElementById('tgNoBonus').classList.remove('on');
        updateDayBk();updateLive();saveState();
    });
    
    document.getElementById('tgNoBonus').addEventListener('click',function(){
        st.withBonus=false;
        this.classList.add('on');
        document.getElementById('tgBonus').classList.remove('on');
        updateDayBk();updateLive();saveState();
    });
    
    document.getElementById('editClose').addEventListener('click',()=>document.getElementById('editOv').classList.remove('show'));
    document.getElementById('editOv').addEventListener('click',e=>{if(e.target.id==='editOv')document.getElementById('editOv').classList.remove('show');});
    
    document.querySelectorAll('.edit-btn').forEach(b=>b.addEventListener('click',function(){
        if(!st.selDay)return;
        setSt(st.selDay.y,st.selDay.m,st.selDay.d,this.dataset.s);
        document.getElementById('editOv').classList.remove('show');
        renderCal();updateLive();
        addXP(10,'–î–µ–Ω—å –æ—Ç–º–µ—á–µ–Ω');
        toast('‚úì –û–±–Ω–æ–≤–ª–µ–Ω–æ');
    }));
    
    // Profile
    document.getElementById('btnEditProfile').addEventListener('click',()=>{
        document.getElementById('profileOv').classList.add('show');
        document.getElementById('profileNameInput').value=st.profile.name;
    });
    document.getElementById('profileClose').addEventListener('click',()=>document.getElementById('profileOv').classList.remove('show'));
    document.getElementById('profileSaveBtn').addEventListener('click',()=>{
        const name=document.getElementById('profileNameInput').value;
        if(name.trim()){
            st.profile.name=name.trim();
            saveState();
            updateProfile();
            document.getElementById('profileOv').classList.remove('show');
            celebrate('‚úÖ');
            toast('‚úì –ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω');
        }
    });
    
    // Goal
    document.getElementById('btnSetGoal').addEventListener('click',()=>document.getElementById('goalOv').classList.add('show'));
    document.getElementById('goalClose').addEventListener('click',()=>document.getElementById('goalOv').classList.remove('show'));
    document.getElementById('goalSaveBtn').addEventListener('click',()=>{
        const name=document.getElementById('goalName').value;
        const target=parseFloat(document.getElementById('goalTarget').value);
        if(target>0){
            st.goal={name:name||'–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª—å',target,enabled:true};
            saveState();
            updateGoal();
            document.getElementById('goalOv').classList.remove('show');
            celebrate('üéØ');
            toast('üéØ –¶–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!');
        }else{
            toast('‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É');
        }
    });
    
    // Quick goals
    document.querySelectorAll('.quick-goal-btn').forEach(btn=>btn.addEventListener('click',function(){
        const amount=parseInt(this.dataset.amount);
        const name=this.textContent.trim().split('-')[0].trim();
        st.goal={name,target:amount,enabled:true};
        saveState();
        updateGoal();
        celebrate('üéØ');
        toast('üéØ –¶–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!');
    }));
    
    document.getElementById('saveBtn').addEventListener('click',saveSet);
    
    document.getElementById('themeBtn').addEventListener('click',()=>{
        const tab=document.getElementById('tab-set');
        document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
        document.querySelector('.nav-item[data-t="set"]').classList.add('active');
        tab.classList.add('active');
    });
    
    document.querySelectorAll('.theme-opt[data-theme]').forEach(opt=>{
        opt.addEventListener('click',function(){
            st.theme=this.dataset.theme;
            applyTheme();
            saveState();
            celebrate('üé®');
            toast('‚úì –¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞');
        });
    });
    
    document.querySelectorAll('.theme-opt[data-color]').forEach(opt=>{
        opt.addEventListener('click',function(){
            st.color=this.dataset.color;
            applyTheme();
            saveState();
            celebrate('‚ú®');
            toast('‚úì –¶–≤–µ—Ç –∏–∑–º–µ–Ω–µ–Ω');
        });
    });
    
    document.getElementById('timerToggle').addEventListener('click',()=>{
        st.notifications=!st.notifications;
        document.getElementById('timerToggle').textContent=st.notifications?'üîî':'üîï';
        saveState();
        toast(st.notifications?'üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã':'üîï –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω—ã');
    });
    }
    
    // Check for milestones
    function checkMilestones(){
        const vahta=findVahta();
        const totalData=calcPeriod(vahta.start,vahta.end,true);
        
        // First day achievement
        if(totalData.workDays===1&&!st.achievements.includes('first')){
            st.achievements.push('first');
            addXP(50,'–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –Ω–∞ –≤–∞—Ö—Ç–µ!');
            celebrate('üåü');
        }
        
        // Week achievement
        if(totalData.workDays===7&&!st.achievements.includes('week')){
            st.achievements.push('week');
            addXP(100,'–ù–µ–¥–µ–ª—è –Ω–∞ –≤–∞—Ö—Ç–µ!');
            celebrate('üî•');
            confetti();
        }
        
        // Month achievement
        if(totalData.workDays===30&&!st.achievements.includes('month')){
            st.achievements.push('month');
            addXP(200,'–ú–µ—Å—è—Ü –Ω–∞ –≤–∞—Ö—Ç–µ!');
            celebrate('üí™');
            confetti();
        }
        
        // 50k milestone
        if(totalData.net>=50000&&!st.achievements.includes('50k')){
            st.achievements.push('50k');
            addXP(150,'–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 50 000‚ÇΩ!');
            celebrate('üí∞');
            confetti();
        }
        
        // 100k milestone
        if(totalData.net>=100000&&!st.achievements.includes('100k')){
            st.achievements.push('100k');
            addXP(300,'–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ 100 000‚ÇΩ!');
            celebrate('üíé');
            confetti();
        }
        
        // Half vahta
        const totalDays=Math.ceil((vahta.end-vahta.start)/86400000)+1;
        const passedDays=Math.ceil((new Date()-vahta.start)/86400000);
        if(passedDays>=totalDays/2&&!st.achievements.includes('half')){
            st.achievements.push('half');
            addXP(100,'–ü–æ–ª–æ–≤–∏–Ω–∞ –≤–∞—Ö—Ç—ã –ø—Ä–æ–π–¥–µ–Ω–∞!');
            celebrate('üéØ');
            confetti();
        }
        
        saveState();
    }

    function init(){
        loadSch();
        loadSet();
        loadState();
        applyTheme();
        
        const now=new Date();
        st.calY=now.getFullYear();
        st.calM=now.getMonth();
        
        updateXP();
        updateLive();
        updateDayBk();
        renderCal();
        
        // Setup all event listeners
        setupEventListeners();
        
        // Update every second
        setInterval(()=>{
            updateLive();
            checkMilestones();
        },1000);
        
        // Daily XP for working
        const today=new Date();
        const lastXPDate=localStorage.getItem('lastXPDate');
        const todayStr=today.toDateString();
        if(lastXPDate!==todayStr){
            const status=getSt(today.getFullYear(),today.getMonth()+1,today.getDate());
            if(status==='vm'||status==='holiday'){
                setTimeout(()=>{
                    addXP(20,'–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ —Ä–∞–±–æ—Ç—É');
                    localStorage.setItem('lastXPDate',todayStr);
                },2000);
            }
        }
    }
    
    document.addEventListener('DOMContentLoaded',init);
</script>
```

</body>
</html>
